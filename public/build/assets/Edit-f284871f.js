import{u as w,a as I,d as S,j as e,l as N,n as le,b as h,w as ne,z as ie,k as H,V as se,W,m as j,f as re,F as V,T as _,U as G,r as C,X as ee,Y as oe,Z,h as ae,c as de,J as ce,s as ue,_ as J,e as K,S as me,K as pe,M as X,O as fe}from"./main-3000a6dc.js";import{G as k,R as he,A as ge}from"./GenerateFields-7282bc65.js";import{S as A}from"./react-select.esm-2a6a39a3.js";import{F as T}from"./index-0aeaf758.js";import{F as ve}from"./FileUploadComponent-37e5f074.js";import{A as _e}from"./AttachmentSection-628d53a2.js";/* empty css                  */import"./index-29603cbb.js";import"./ClearButtonComponent-21bbcf28.js";const be=()=>{var i,s,g,r,v,b,y,m,n,c,t,f,o,x,D,F,O,q,E,P,M,B,L,Y,Q,R,U,$,z;const p=w();new I;const a=S(u=>u.salesOrderForm),l=(u,te)=>{p(_({[u]:te}))},d={Header:{"Account Name":e(N,{defaultOptions:!0,isMulti:!1,required:!0,id:"account_id",placeholder:"Type at least 2 characters to search...",name:"account_id",loadOptions:le,onChange:({value:u})=>{l("account_id",u)},className:"flex-1",defaultValue:{value:(i=a.account)==null?void 0:i.id,label:e("div",{className:"flex items-center",children:h("div",{children:[e("div",{className:"text-sm font-bold",children:(s=a.account)==null?void 0:s.account_name}),e("div",{className:"text-xs text-gray-500",children:(g=a.account)==null?void 0:g.email})]})},(r=a.account)==null?void 0:r.id)}}),"Contact Name":e(N,{defaultOptions:!0,isMulti:!1,id:"contact_id",placeholder:"Type at least 2 characters to search...",name:"contact_id",loadOptions:ne,onChange:({value:u})=>{l("contact_id",u)},className:"flex-1",defaultValue:{value:(v=a.contact)==null?void 0:v.id,label:h("div",{className:"flex items-center",children:[a.contact?e("img",{src:a.contact.image??"/assets/images/user-profile.jpeg",alt:"avatar",className:"w-8 h-8 mr-2 rounded-full"}):null,h("div",{children:[e("div",{className:"text-sm font-bold",children:((b=a.contact)==null?void 0:b.first_name)+" "+((y=a.contact)==null?void 0:y.last_name)}),e("div",{className:"text-xs text-gray-500",children:(m=a.contact)==null?void 0:m.email})]})]},(n=a.contact)==null?void 0:n.id)}}),"Quote Name":e(N,{defaultOptions:!0,isMulti:!1,id:"quote_id",placeholder:"Type at least 2 characters to search...",name:"quote_id",loadOptions:ie,onChange:({value:u})=>{l("quote_id",u)},className:"flex-1",defaultValue:{value:(c=a.quote)==null?void 0:c.id,label:e("div",{className:"flex items-center",children:e("div",{className:"text-sm font-bold",children:(t=a.quote)==null?void 0:t.subject})},(f=a.quote)==null?void 0:f.id)}}),Currency:e(A,{options:H,name:"currency",id:"currency",onChange:({value:u})=>{l("currency",u)},className:"flex-1",defaultValue:H.find(u=>u.value==a.currency)})},"":{"Deals Name":e(N,{defaultOptions:!0,isMulti:!1,id:"deal_id",placeholder:"Type at least 2 characters to search...",name:"deal_id",loadOptions:se,onChange:({value:u})=>{l("deal_id",u)},className:"flex-1",defaultValue:{value:(o=a.deal)==null?void 0:o.id,label:e("div",{className:"flex items-center",children:e("div",{className:"text-sm font-bold",children:(x=a.deal)==null?void 0:x.deal_name})},(D=a.deal)==null?void 0:D.id)}}),"Deal Stage":e(A,{options:W,name:"deal_stage",id:"deal_stage",onChange:({value:u})=>{l("deal_stage",u)},className:"flex-1",defaultValue:W.find(u=>u.value==a.deal_stage)}),"SalesOrders Owner":e(N,{defaultOptions:!0,isMulti:!1,id:"owner_id",placeholder:"Type at least 2 characters to search...",name:"owner_id",loadOptions:j,onChange:({value:u})=>{l("owner_id",u)},className:"flex-1",defaultValue:{value:(F=a.owner)==null?void 0:F.id,label:h("div",{className:"flex items-center",children:[a.owner?e("img",{src:re(a.owner.avatar_data),alt:"avatar",className:"w-8 h-8 mr-2 rounded-full"}):null,h("div",{children:[e("div",{className:"text-sm font-bold",children:((O=a.owner)==null?void 0:O.first_name)+" "+((q=a.owner)==null?void 0:q.last_name)}),e("div",{className:"text-xs text-gray-500",children:(E=a.owner)==null?void 0:E.email})]})]},(P=a.owner)==null?void 0:P.id)}}),"Sales Person":e(N,{defaultOptions:!0,isMulti:!1,id:"sales_person_id",placeholder:"Type at least 2 characters to search...",name:"sales_person_id",loadOptions:j,onChange:({value:u})=>{l("sales_person_id",u)},className:"flex-1",defaultValue:{value:(M=a.sales_person)==null?void 0:M.id,label:h("div",{className:"flex items-center",children:[a.sales_person?e("img",{src:a.sales_person.image??"/assets/images/user-profile.jpeg",alt:"avatar",className:"w-8 h-8 mr-2 rounded-full"}):null,h("div",{children:[e("div",{className:"text-sm font-bold",children:(B=a.sales_person)==null?void 0:B.name}),e("div",{className:"text-xs text-gray-500",children:(L=a.sales_person)==null?void 0:L.email})]})]},(Y=a.sales_person)==null?void 0:Y.id)}}),"Approved By":e(N,{defaultOptions:!0,isMulti:!1,id:"approved_by_id",placeholder:"Type at least 2 characters to search...",name:"approved_by_id",loadOptions:j,onChange:({value:u})=>{l("approved_by_id",u)},className:"flex-1",defaultValue:{value:(Q=a.approved_by)==null?void 0:Q.id,label:h("div",{className:"flex items-center",children:[a.approved_by?e("img",{src:a.approved_by.image??"/assets/images/user-profile.jpeg",alt:"avatar",className:"w-8 h-8 mr-2 rounded-full"}):null,h("div",{children:[e("div",{className:"text-sm font-bold",children:((R=a.approved_by)==null?void 0:R.first_name)+" "+((U=a.approved_by)==null?void 0:U.last_name)}),e("div",{className:"text-xs text-gray-500",children:($=a.approved_by)==null?void 0:$.email})]})]},(z=a.approved_by)==null?void 0:z.id)}}),"Exchange Rate":e("input",{id:"exchange_rate",name:"exchange_rate",type:"text",className:"flex-1 form-input disabled:pointer-events-none disabled:bg-[#eee] dark:disabled:bg-[#1b2e4b] cursor-not-allowed",disabled:!0,defaultValue:a.exchange_rate??1})}};return e(V,{children:e("div",{className:"flex justify-between lg:flex-row flex-col",children:e(k,{fields:d})})})},ye=()=>{const p=w();new I;const a=S(s=>s.salesOrderForm),l=(s,g)=>{p(_({[s]:g}))},d=[{value:"none",label:"-None-"},{value:"single_order",label:"Single Order"},{value:"frame_contract",label:"Frame Contract"},{value:"call_off",label:"Call Off"},{value:"forecast",label:"Forecast"}],i={"Sales Orders Information":{"Purchase Order":e("input",{id:"purchase_order",name:"purchase_order",className:"form-input flex-1 ",onChange:s=>l(s.target.name,s.target.value),defaultValue:a.purchase_order}),"Customer PO Date":e(T,{options:{dateFormat:"Y-m-d ",position:"auto left",defaultDate:a.customer_po_date?new Date(a.customer_po_date):null},name:"customer_po_date",value:a.customer_po_date?new Date(a.customer_po_date):"",className:"form-input flex-1",onChange:(s,g)=>l("customer_po_date",g)}),"PO Upload":e(ve,{id:"po_upload",modelName:"salesOrder",formState:a,formAttribute:"po_upload",updateFormData:_}),"SO Type":e(A,{options:d,name:"so_type",id:"so_type",onChange:({value:s})=>{l("so_type",s)},className:"flex-1",defaultValue:d.find(s=>s.value==a.so_type)}),"Parent SO Nr.":e("input",{id:"parent_so_nr",name:"parent_so_nr",className:"form-input flex-1 ",onChange:s=>l(s.target.name,s.target.value),defaultValue:a.parent_so_nr})},"":{Subject:e("input",{id:"subject",required:!0,name:"subject",className:"form-input flex-1 ",onChange:s=>l(s.target.name,s.target.value),defaultValue:a.subject}),Pending:e("input",{id:"pending",name:"pending",className:"form-input flex-1 ",onChange:s=>l(s.target.name,s.target.value),defaultValue:a.pending}),Status:e(A,{options:G,name:"status",id:"status",onChange:({value:s})=>{l("status",s)},className:"flex-1",defaultValue:G.find(s=>s.value==a.status)}),ZohoBooksID:e("input",{id:"zoho_books_id",name:"zoho_books_id",className:"form-input flex-1 ",onChange:s=>l(s.target.name,s.target.value),defaultValue:a.zoho_books_id})}};return e(V,{children:e("div",{className:"flex justify-between lg:flex-row flex-col",children:e(k,{fields:i})})})},xe=()=>{const p=S(n=>n.salesOrderForm),[a,l]=C.useState([]),d=w(),i=new I,[s,g]=C.useState({total:0,...p.summary}),r=(n,c,t)=>{const f=a.find(O=>O.id===t),o=a.findIndex(O=>O.id===t),x={...f,[n]:c},D={...x,amount:parseInt(x.quantity??0)*parseFloat(x.list_price??0)},F={...a,[o]:D};l(Object.values(F)),d(_({items:F}))},v=async(n,c)=>{const t=await i.fetchSingleProduct(n);if(t.status!==200)return;const f=t.data.data.product,o=a.find(q=>q.id===c),x=a.findIndex(q=>q.id===c),D={...o,product_id:n,list_price:f.unit_price??0,description:f.description},F={...D,amount:parseInt(D.quantity??0)*parseFloat(D.list_price??0)},O={...a,[x]:F};l(Object.values(O)),d(_({items:O}))},b=()=>{let n;n=a!=null&&a.length?a.reduce((t,f)=>f.id>t?f.id:t,a[0].id):0;let c=[...a,{id:n+1,amount:0,list_price:0}];l(c),d(_({items:c}))};C.useEffect(()=>{d(_({summary:s}))},[s]);const y=(n=null)=>{const c=a.filter(t=>t.id!=n.id);l(c),d(_({items:c}))};C.useEffect(()=>{l(Object.values(p.items))},[]);const m=()=>{const n=a.reduce((c,t)=>c+(parseFloat(t.amount)||0),0);g({total:n})};return C.useEffect(()=>{m()},[a]),e(V,{children:e("div",{className:"flex justify-between lg:flex-row flex-col",children:e("div",{className:" w-full ltr:lg:mr-12 rtl:lg:ml-12 mb-12 ",children:h("div",{className:"",children:[h("div",{className:"text-lg",children:["Ordered Items",e(he,{})," :"]}),h("div",{className:"mt-8",children:[e("div",{className:"overflow-x-auto	w-11/12",children:h("table",{className:"table-auto overflow-scroll w-full",children:[e("thead",{children:h("tr",{children:[e("th",{className:"w-1",children:"Product Name"}),e("th",{className:"w-1",children:"Quantity"}),e("th",{className:"w-1",children:"Customer Part ID"}),e("th",{className:"w-1",children:"List Price"}),e("th",{className:"w-1",children:"Date Code"}),e("th",{className:"w-1",children:"Amount"}),e("th",{className:"w-1",children:"Requested Delivery Date"}),e("th",{className:"w-1",children:"Estimated Delivery Date"})]})}),e("tbody",{children:a.map(n=>{var c,t,f;return h("tr",{className:"align-top",children:[h("td",{children:[e(N,{defaultOptions:!1,isMulti:!1,id:"product_id",name:"product_id",placeholder:"Type at least 2 characters to search...",loadOptions:ee,onChange:({value:o})=>{v(o,n.id)},defaultValue:n.product?{value:(c=n.product)==null?void 0:c.id,label:e("div",{className:"flex items-center",children:e("div",{children:e("div",{className:"text-sm font-bold",children:(t=n.product)==null?void 0:t.product_name})})},(f=n.product)==null?void 0:f.id)}:null,className:"flex-1  min-w-[200px]"}),e("textarea",{name:"description",className:"form-textarea mt-4",placeholder:"Enter Description",onChange:o=>r(o.target.name,o.target.value,n.id),defaultValue:n.description})]}),e("td",{children:e("input",{type:"number",className:"form-input w-32",placeholder:"Quantity",name:"quantity",min:0,onChange:o=>r(o.target.name,o.target.value,n.id),defaultValue:n.quantity})}),e("td",{children:e("input",{name:"customer_part_id",type:"text",className:"form-input min-w-[200px]",onChange:o=>r(o.target.name,o.target.value,n.id),defaultValue:n.customer_part_id})}),e("td",{children:e("input",{type:"number",className:"form-input w-32",placeholder:"Price",name:"list_price",min:0,defaultValue:n.list_price,onChange:o=>r(o.target.name,o.target.value,n.id)})}),e("td",{children:e("input",{name:"date_code",type:"text",className:"form-input min-w-[200px]",defaultValue:n.date_code,onChange:o=>r(o.target.name,o.target.value,n.id)})}),e("td",{children:e("input",{name:"amount",type:"text",value:n.amount,className:"flex-1 form-input min-w-[200px] disabled:pointer-events-none disabled:bg-[#eee] dark:disabled:bg-[#1b2e4b] cursor-not-allowed",disabled:!0,onChange:o=>r(o.target.name,o.target.value,n.id)})}),e("td",{children:e(T,{name:"requested_delivery_date",options:{dateFormat:"Y-m-d",position:"auto left",defaultDate:`${n.requested_delivery_date?new Date(n.requested_delivery_date):""}`},placeholder:"Y-m-d",className:"form-input flex-1 min-w-[200px]",onChange:(o,x)=>r("requested_delivery_date",x,n.id),defaultValue:n.requested_delivery_date})}),e("td",{children:e(T,{name:"estimated_delivery_date",options:{dateFormat:"Y-m-d",position:"auto left",defaultDate:`${n.estimated_delivery_date?new Date(n.estimated_delivery_date):""}`},placeholder:"Y-m-d",className:"form-input flex-1 min-w-[200px]",onChange:(o,x)=>r("estimated_delivery_date",x,n.id),defaultValue:n.estimated_delivery_date})}),e("td",{children:e("button",{type:"button",onClick:()=>y(n),children:h("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})})]},n.id)})})]})}),h("div",{className:"flex justify-between sm:flex-row flex-col mt-6 px-4",children:[e("div",{className:"sm:mb-0 mb-6",children:e("button",{type:"button",className:"btn btn-primary",onClick:()=>b(),children:"Add Item"})}),e("div",{className:"sm:w-2/5",children:h("div",{className:"flex items-center justify-between mt-4 font-semibold",children:[e("div",{className:"flex-1",children:"Total(€)"}),e("input",{id:"total",name:"total",type:"text",value:s.total,className:"w-64 form-input disabled:pointer-events-none disabled:bg-[#eee] dark:disabled:bg-[#1b2e4b] cursor-not-allowed",disabled:!0})]})})]})]})]},"Quote Items")})})})},Ne=()=>{var i,s,g;const p=w();new I;const a=S(r=>r.salesOrderForm),l=(r,v)=>{p(_({[r]:v}))},d={"SO line":{"Requested Delivery Date":e(T,{options:{dateFormat:"Y-m-d ",position:"auto left",defaultDate:a.requested_delivery_date?new Date(a.requested_delivery_date):null},name:"requested_delivery_date",value:a.requested_delivery_date?new Date(a.requested_delivery_date):"",className:"form-input flex-1",onChange:(r,v)=>l("requested_delivery_date",v)}),"Product Name":e(N,{defaultOptions:!1,isMulti:!1,id:"product_id",placeholder:"Type at least 2 characters to search...",name:"product_id",loadOptions:ee,onChange:({value:r})=>{l("product_id",r)},className:"flex-1",defaultValue:{value:(i=a.product)==null?void 0:i.id,label:e("div",{className:"flex items-center",children:e("div",{className:"text-sm font-bold",children:(s=a.product)==null?void 0:s.product_name})},(g=a.product)==null?void 0:g.id)}}),"Customer part Id":e("input",{id:"customer_part_id",name:"customer_part_id",className:"form-input flex-1 ",onChange:r=>l(r.target.name,r.target.value),defaultValue:a.customer_part_id}),Quantity:e("input",{id:"quantity",name:"quantity",className:"form-input flex-1 ",type:"number",onChange:r=>l(r.target.name,r.target.value),defaultValue:a.quantity}),"List Price":e("input",{type:"number",id:"list_price",name:"list_price",className:"form-input flex-1 ",onChange:r=>l(r.target.name,r.target.value),defaultValue:a.list_price})},"":{"Estimated Delivery Date":e(T,{options:{dateFormat:"Y-m-d ",position:"auto left",defaultDate:a.estimated_delivery_date?new Date(a.estimated_delivery_date):null},name:"estimated_delivery_date",value:a.estimated_delivery_date?new Date(a.estimated_delivery_date):"",className:"form-input flex-1",onChange:(r,v)=>l("estimated_delivery_date",v)}),"Date Code":e("input",{id:"date_code",name:"date_code",className:"form-input flex-1 ",onChange:r=>l(r.target.name,r.target.value),defaultValue:a.date_code}),SPQ:e("input",{id:"spq",name:"spq",className:"form-input flex-1 ",onChange:r=>l(r.target.name,r.target.value),defaultValue:a.spq}),comment:e("input",{id:"comment",name:"comment",className:"form-input flex-1 ",onChange:r=>l(r.target.name,r.target.value),defaultValue:a.comment})}};return e(V,{children:e("div",{className:"flex justify-between lg:flex-row flex-col",children:e(k,{fields:d})})})},Ce=()=>{var g,r,v,b,y,m,n,c;const p=w(),a=new I,l=S(t=>t.salesOrderForm),d=(t,f)=>{p(_({[t]:f}))},i=async t=>{const f=await a.fetchSingleAvailability(t);if(f.status!=200)return;const o=f.data.data.availability;p(_({availability:o}))},s={"Linked Availability":{"Availability Name":e(N,{defaultOptions:!1,isMulti:!1,id:"availability_id",placeholder:"Type at least 2 characters to search...",name:"availability_id",loadOptions:oe,onChange:({value:t})=>{d("availability_id",t),i(t)},className:"flex-1",defaultValue:{value:(g=l.availability)==null?void 0:g.id,label:e("div",{className:"flex items-center",children:e("div",{className:"text-sm font-bold",children:(r=l.availability)==null?void 0:r.availability_name})},(v=l.availability)==null?void 0:v.id)}}),"Availability No":e("input",{id:"availability_no",name:"availability_no",className:"form-input flex-1 disabled:pointer-events-none bg-[#eee] ",disabled:!0,onChange:t=>d(t.target.name,t.target.value),defaultValue:(b=l.availability)==null?void 0:b.availability_no}),"Availability Cost":e("input",{type:"number",id:"availability_cost",name:"availability_cost",className:"form-input flex-1  disabled:pointer-events-none bg-[#eee]",disabled:!0,onChange:t=>d(t.target.name,t.target.value),defaultValue:(y=l.availability)==null?void 0:y.cost})},"":{"Availability Quantity":e("input",{type:"number",disabled:!0,id:"availability_quantity",name:"availability_quantity",className:"form-input flex-1 disabled:pointer-events-none bg-[#eee]",onChange:t=>d(t.target.name,t.target.value),defaultValue:(m=l.availability)==null?void 0:m.quantity}),"Availability LT":e("input",{id:"availability_lt",name:"availability_lt",disabled:!0,className:"form-input flex-1 disabled:pointer-events-none bg-[#eee] ",onChange:t=>d(t.target.name,t.target.value),defaultValue:(n=l.availability)==null?void 0:n.lead_time}),"Availability DC":e("input",{disabled:!0,id:"availability_dc",name:"availability_dc",className:"form-input flex-1 disabled:pointer-events-none bg-[#eee]",onChange:t=>d(t.target.name,t.target.value),defaultValue:(c=l.availability)==null?void 0:c.date_code})}};return e(V,{children:e("div",{className:"flex justify-between lg:flex-row flex-col",children:e(k,{fields:s})})})},we=()=>{var i,s,g,r,v,b,y,m,n,c;const p=w();new I;const a=S(t=>t.salesOrderForm),l=(t,f)=>{p(_({[t]:f}))},d={"Address Information":{"Billing Street":e("input",{id:"billing_street",name:"billing_street",onChange:t=>l(t.target.name,t.target.value),value:a.billing_street||((i=a.account)==null?void 0:i.billing_street)||"",className:"form-input flex-1"}),"Billing City":e("input",{id:"billing_city",name:"billing_city",value:a.billing_city||((s=a.account)==null?void 0:s.billing_city)||"",onChange:t=>l(t.target.name,t.target.value),className:"form-input flex-1"}),"Billing State":e("input",{id:"billing_state",name:"billing_state",value:a.billing_state||((g=a.account)==null?void 0:g.billing_state)||"",onChange:t=>l(t.target.name,t.target.value),className:"form-input flex-1"}),"Billing Code":e("input",{id:"billing_code",name:"billing_code",value:a.billing_code||((r=a.account)==null?void 0:r.billing_code)||"",onChange:t=>l(t.target.name,t.target.value),className:"form-input flex-1"}),"Billing Country":e("input",{id:"billing_country",name:"billing_country",value:a.billing_country||((v=a.account)==null?void 0:v.billing_country)||"",onChange:t=>l(t.target.name,t.target.value),className:"form-input flex-1"})},"":{"Shipping Street":e("input",{id:"shipping_street",name:"shipping_street",value:a.shipping_street||((b=a.account)==null?void 0:b.shipping_street)||"",onChange:t=>l(t.target.name,t.target.value),className:"form-input flex-1"}),"Shipping City":e("input",{id:"shipping_city",name:"shipping_city",value:a.shipping_city||((y=a.account)==null?void 0:y.shipping_city)||"",onChange:t=>l(t.target.name,t.target.value),className:"form-input flex-1"}),"Shipping State":e("input",{id:"shipping_state",name:"shipping_state",value:a.shipping_state||((m=a.account)==null?void 0:m.shipping_state)||"",onChange:t=>l(t.target.name,t.target.value),className:"form-input flex-1"}),"Shipping Code":e("input",{id:"shipping_code",name:"shipping_code",value:a.shipping_code||((n=a.account)==null?void 0:n.shipping_code)||"",onChange:t=>l(t.target.name,t.target.value),className:"form-input flex-1"}),"Shipping Country":e("input",{id:"shipping_country",name:"shipping_country",value:a.shipping_country||((c=a.account)==null?void 0:c.shipping_country)||"",onChange:t=>l(t.target.name,t.target.value),className:"form-input flex-1"})}};return e(V,{children:e("div",{className:"flex justify-between lg:flex-row flex-col",children:e(k,{fields:d})})})},Se=()=>{const p=S(i=>i.salesOrderForm),a=w();new I;const l=(i,s)=>{a(_({[i]:s}))},d={"Terms and Conditions":{"Terms and Conditions":e("textarea",{id:"terms_conditions",rows:3,name:"terms_conditions",className:"form-textarea flex-1",placeholder:"",onChange:i=>l(i.target.name,i.target.value),defaultValue:p.terms_conditions})},"":{}};return e(V,{children:e("div",{className:"flex justify-between lg:flex-row flex-col",children:e(k,{fields:d})})})},Oe=()=>{const p=S(i=>i.salesOrderForm),a=w();new I;const l=(i,s)=>{a(_({[i]:s}))},d={"Description Information":{Description:e("textarea",{id:"description",rows:3,name:"description",className:"form-textarea flex-1",placeholder:"",onChange:i=>l(i.target.name,i.target.value),defaultValue:p.description})},"":{}};return e(V,{children:e("div",{className:"flex justify-between lg:flex-row flex-col",children:e(k,{fields:d})})})},Ie=()=>{const p=w(),a=S(i=>i.salesOrderForm),l=(i,s)=>{p(_({[i]:s}))},d={"Technical information":{"Waiting for approval":e("input",{id:"waiting_approval",type:"checkbox",name:"waiting_approval",className:"form-checkbox",onChange:i=>l(i.target.name,i.target.checked),defaultChecked:a.waiting_approval}),Approval:e("input",{id:"approval",type:"checkbox",name:"approval",className:"form-checkbox",onChange:i=>l(i.target.name,i.target.checked),defaultChecked:a.approval}),"Approve Changes":e(A,{options:Z,name:"approval_changes",id:"approval_changes",onChange:({value:i})=>{l("approval_changes",i)},className:"flex-1",defaultValue:Z.find(i=>i.value==a.approval_changes)}),Tech:e("input",{id:"tech",type:"checkbox",name:"tech",className:"form-checkbox",onChange:i=>l(i.target.name,i.target.checked),defaultChecked:a.tech})},"":{"Technical info":e("textarea",{id:"tech_info",rows:2,name:"tech_info",className:"form-textarea flex-1",placeholder:"",defaultValue:a.tech_info,onChange:i=>l(i.target.name,i.target.value)}),Subform:e("textarea",{id:"subform",rows:2,name:"subform",className:"form-textarea flex-1",placeholder:"",defaultValue:a.subform,onChange:i=>l(i.target.name,i.target.value)})}};return e(V,{children:e("div",{className:"flex justify-between lg:flex-row flex-col",children:e(k,{fields:d})})})},Ve=()=>{const a=ae().id;return h("div",{className:"mt-8 px-4",children:[e(be,{},"HeaderSection"),e("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),e(ye,{},"SalesOrderInformationSection"),e("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),e(xe,{},"SalesItemsSection"),e("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),e(Ne,{},"SOLineSection"),e("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),e(Ce,{},"LinkedAvailabilitySection"),e("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),e(we,{},"AddressInformationSection"),e("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),e(Se,{},"TermsConditionsSection"),e("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),e(Oe,{},"DescriptionInformationSection"),e("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),e(Ie,{},"TechnicalInformationSection"),e("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),e(_e,{modelId:a,modelName:"salesOrder"})]})},Me=()=>{const{hasPermission:p}=de(),a=S(m=>m.salesOrderForm),[l,d]=C.useState(!0),s=ae().id,g=new I,r=w(),v=ce();C.useEffect(()=>{r(ue("SalesOrder Edit"))}),C.useEffect(()=>{r(J())},[]);const b=async()=>{const m=await g.fetchSingleSalesOrder(s);if(m.status!=200)return;const n=m.data.data.salesOrder;r(_(n))};C.useEffect(()=>{b().then(()=>{d(!1)})},[s]),C.useEffect(()=>{r(_({api:"updateSingleSalesOrder",redirectTo:"/sales/edit/:id",action:"edit"}))},[]);const y=async()=>{try{const m=await g.convertSalesOrderToInvoice({id:a.id});if(m.status==200)me.fire({title:"SalesOrder Converted Successfully.",html:`
                <span class="text-blue-500">Do you want to redirect to created Invoice ? </span>
                `,showCancelButton:!0,icon:"success",confirmButtonText:"Redirect",denyButtonText:"Close",customClass:{title:"text-blue-500"}}).then(n=>{var c,t;n.isConfirmed&&v(`/invoice/edit/${(t=(c=m.data)==null?void 0:c.invoice)==null?void 0:t.id}`,{replace:!0})});else if(m.status===422){const n=m.data.errors,c={titleMessage:"You have validation error on converting Sales Order",hasError:!0,...Object.fromEntries(Object.entries(n).map(([t,f])=>[t,f[0]]))};r(pe(c)),X.fire({icon:"error",html:`<h5>Convert Validation Error</h5>
                        <span style="font-size: 12px">Please Check fields</span>
                        `,padding:"10px 20px"})}else X.fire({icon:"error",title:"Internal Server Error ,Converting Sales Order failed failed",padding:"10px 20px"})}catch(m){fe("Failed to convert Sales Order"),console.error(m);return}};return l?e(K,{}):!p("update-sales-order")||l?e(K,{}):h("div",{className:"px-4",children:[e(ge,{formState:a,resetForm:J}),e("div",{className:"flex xl:flex-row flex-col gap-2.5",children:h("div",{className:"panel px-0 flex-1 py-6 ltr:xl:mr-6 rtl:xl:ml-6 overflow-hidden",children:[e("div",{className:"flex items-center gap-2",children:e("button",{onClick:y,className:"mx-2 btn btn-secondary",children:"Convert SO to Invoice"})}),e(Ve,{})]})})]})};export{Me as default};
