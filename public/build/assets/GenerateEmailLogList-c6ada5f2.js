import{b as o,F as _,j as t,u as ne,d as y,c as le,r as a,e as oe,a as A,p as ce,S as ie}from"./main-cc930730.js";import{s as R,Q as de}from"./sortBy-e6be9ca1.js";import{V as me}from"./CommonIcons-0c4cb687.js";const ue=({title:l,leftObjects:b,rightObjects:g})=>o(_,{children:[o("h2",{className:"text-xl pb-5",children:[l," :"]}),t("div",{className:"pl-5 flex justify-between lg:flex-row flex-col gap-6 flex-wrap",children:o("div",{className:"flex justify-between sm:flex-row flex-col gap-6 ",children:[t("div",{className:"",children:b.map((c,u)=>t(F,{label:c.label,value:c.value},u))}),t("div",{className:"",children:g&&g.map((c,u)=>t(F,{label:c.label,value:c.value},u))})]})})]}),F=({label:l,value:b})=>o("div",{className:"flex items-center w-full justify-between mb-2",children:[o("div",{className:"text-white-dark mx-1",children:[l," : "]}),t("div",{children:b})]}),ve=({permissionName:l,type:b,routeName:g,modelId:c,title:u})=>{const T=ne();y(e=>e.filters);const{hasPermission:z,isLoading:fe,isLoggedIn:he}=le(),[E,v]=a.useState(!0);a.useState(!1);const L=new A,B=y(e=>e.themeConfig.theme)==="dark",[S,G]=a.useState([]);a.useState([]),a.useState([]),a.useState(""),a.useState([]);const[p,x]=a.useState(1),w=[50,100],[i,J]=a.useState(w[0]),[N,H]=a.useState(R(S,"id")),[Q,U]=a.useState(N),[V,W]=a.useState([]),[Y,Z]=a.useState(0),[f,q]=a.useState({columnAccessor:"id",direction:"asc"}),K=new A;y(e=>e.emailLogForm);const[X,C]=a.useState(!1),[$,ee]=a.useState(null);let j={leftObjects:[],rightObjects:[]};const te=e=>{var s,r,d,h,n,m;j={leftObjects:[{label:"Sender Name",value:`${(e.sender_name??"").substring(0,20)}${e.sender_name&&e.sender_name.length>15?"...":""}`},{label:"Is Open",value:`${e.is_open??""}`},{label:"Creator",value:`${((s=e.creator)==null?void 0:s.first_name)??""} ${((r=e.creator)==null?void 0:r.last_name)??""}`},{label:"Modifier",value:`${((d=e.modifier)==null?void 0:d.first_name)??""} ${((h=e.modifier)==null?void 0:h.last_name)??""}`},{label:"Mail Status",value:`${e.mail_status??""}`}],rightObjects:[{label:"Owner",value:`${((n=e.owner)==null?void 0:n.first_name)??""} ${((m=e.owner)==null?void 0:m.last_name)??""}`},{label:"Sent At",value:`${e.sent_at??""}`},{label:"Tracking Uuid",value:`${e.tracking_uuid??""}`},{label:"Type",value:`${e.type??""}`},{label:"Opened At",value:`${e.opened_at??""}`}]},ee(j),C(!0)},se=async e=>{const s=await K.fetchSingleEmailLog(e);if(s.status!=200)return;const r=s.data.data;te(r),T(ce(r))},O=()=>{C(!1)},ae=[{accessor:"Subject",sortable:!0,render:({subject:e,id:s})=>t("div",{className:"font-semibold",children:`#${e}`})},{accessor:"receiver_mail",title:"Receiver Mail",sortable:!0,render:({receiver_mail:e})=>t("div",{className:"flex items-center font-semibold",children:e})},{accessor:"owner",title:"Owner",sortable:!1,render:({owner:e})=>t("div",{className:"flex items-center font-semibold",children:e?e.first_name+" "+e.last_name:"No Owner"})},{accessor:"type",title:"Type - Class",sortable:!0,render:({type:e})=>t("div",{className:"flex items-center font-semibold",children:e})},{accessor:"sender_email",title:"Sender Mail",sortable:!0,render:({sender_email:e})=>t("div",{className:"flex items-center font-semibold",children:e})},{accessor:"sender_type",title:"Sender Type",sortable:!0,render:({sender_type:e})=>t("div",{className:"flex items-center font-semibold",children:e})},{accessor:"status",title:"Status",sortable:!0,render:({status:e})=>t("div",{className:"flex items-center font-semibold",children:e})},{accessor:"created_at",title:"Created time",sortable:!0,render:({created_at:e})=>{const s=new Date(e),r=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],d=s.getHours(),h=String(s.getMinutes()).padStart(2,"0"),n=d>=12?"PM":"AM",m=`${r[s.getMonth()]} ${s.getDate()}, ${s.getFullYear()} ${d%12||12}:${h} ${n}`;return t("div",{className:"font-semibold",children:m})}},{accessor:"action",sortable:!1,render:({id:e})=>t("button",{type:"button",className:"flex hover:text-danger",onClick:()=>se(e),children:t(me,{})})}],P=(e="",s="success")=>{ie.mixin({toast:!0,position:"top",showConfirmButton:!1,timer:3e3,customClass:{container:"toast"}}).fire({icon:s,title:e,padding:"10px 20px"})},M=async(e=1,s=w[0],r={})=>{v(!0);const{columnAccessor:d="",direction:h=""}=r;try{await L[g]({page:e,pageSize:s,sortField:d,sortDirection:h,modelId:c}).then(n=>{var m,I,k,D;G((I=(m=n.data)==null?void 0:m.data)==null?void 0:I.data),Z((D=(k=n.data)==null?void 0:k.data)==null?void 0:D.total),v(!1)}).catch(n=>{console.error("Error fetching data: ",n),v(!1),P(`Error fetching  ${l} data.`,"error")})}catch(n){P(`Error fetching ${l} data.`,"error"),console.error("Error fetching data: ",n),v(!1)}},re=e=>{const{columnAccessor:s,direction:r="asc"}=e;q({columnAccessor:s,direction:r}),x(1),M(p,i,{columnAccessor:s,direction:r})};return a.useEffect(()=>{const e=R(S,f.columnAccessor),s=f.direction!=="asc"?e.reverse():e;H(s)},[S,f]),a.useEffect(()=>{x(1)},[i]),a.useEffect(()=>{U([...N.slice(0,i)])},[p,i,N]),a.useEffect(()=>{M(p,i,f)},[p,i,f]),!z(`${l}`)||E?t(oe,{}):t(_,{children:t("div",{className:"px-0 ",children:o("div",{className:`${l}-table`,children:[t("div",{className:"text-base mb-5",children:u?`${u}`:t("div",{className:""})}),t("div",{className:"grid grid-cols-1 gap-6 m-0 ",children:t("div",{className:"panel col-span-12",children:t("div",{className:"datatables pagination-padding",children:E?t("div",{className:"flex justify-center",children:t("span",{className:"animate-spin border-4 my-4 border-success border-l-transparent rounded-full w-12 h-12 inline-block align-middle m-auto mb-10"})}):o(_,{children:[t(de,{className:`${B} whitespace-nowrap table-hover`,records:Q,columns:ae,highlightOnHover:!0,totalRecords:Y,recordsPerPage:i,page:p,onPageChange:x,recordsPerPageOptions:w,onRecordsPerPageChange:J,sortStatus:f,onSortStatusChange:re,selectedRecords:V,onSelectedRecordsChange:W,paginationText:({from:e,to:s,totalRecords:r})=>`Showing ${e} to ${s} of ${r} entries`}),X&&$&&o("div",{className:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 p-8 bg-white shadow-md rounded z-50 border  shadow-gray-300",children:[t("div",{className:"absolute top-2 right-2 cursor-pointer",onClick:O,children:t("svg",{className:"w-6 h-6 text-gray-600 hover:text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:t("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),t(ue,{title:"Email Log",leftObjects:$.leftObjects,rightObjects:$.rightObjects}),t("div",{className:"mt-auto px-2 py-3 sm:flex sm:flex-row-reverse sm:px-3 my-5",children:t("button",{className:"fixed bottom-5 w-full justify-center rounded-md bg-red-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-red-500 sm:ml-3 sm:w-auto",onClick:O,children:"Close"})})]})]})})})})]})})})};export{ue as E,ve as G};
