import{c as ce,u as ue,r as n,h as me,d as de,s as be,ax as fe,aP as H,j as t,e as z,b as s,f as he,i as X,S as G,X as o,W as u,a as pe}from"./main-d43b918e.js";import{I as ge}from"./InfoListComponent-477c8835.js";import{A as ve}from"./ActionButtonsPreview-ba9703c7.js";import{I as r}from"./InformationSectionPreview-2b5daa63.js";import{M as J}from"./MultipleLineSectionPreview-d29f72b3.js";import{T as K}from"./TableSectionPreview-49d99044.js";import{A as ye}from"./AttachmentSection-46c244f1.js";import{A as _e}from"./AttachmentDownloadButton-b9487ee0.js";import{a as we,b as $e,V as Se}from"./CommonIcons-e725f090.js";import{E as je}from"./ExtraEmailLogDataSectionPreview-3965f967.js";const Le=()=>{var S,j,O,k,C,x,N,P,E,q,D,B,I,L,A,Q,T,M;const{hasPermission:f}=ce(),m=ue(),[d,Y]=n.useState(!0),i=me().id,c=new pe,e=de(a=>a.quoteForm),[Z,h]=n.useState(!1),[b,ee]=n.useState(null);n.useEffect(()=>{m(be("Quote Preview"))});const te=()=>{window.print()},ae=async()=>{const a=await c.fetchSingleQuote(i);if(a.status!=200)return;const l=a.data.data.quote;m(H(l))},le=async()=>{G.fire({icon:"info",title:"Are you sure?",showCancelButton:!0,showDenyButton:!0,confirmButtonText:"Send",denyButtonText:"Send With Attachment",denyButtonColor:"#000000",padding:"2em",customClass:{container:"sweet-alerts",denyButton:"btn btn-info "}}).then(async a=>{a.isConfirmed&&(o("Processing Sending Email"),(await c.quotationEmail(i)).status!=200&&u("Problem on sending email"),o("Email sent successfully")),a.isDenied&&(o("Processing Sending Email"),(await c.quotationEmail(i,!0)).status!=200&&u("Problem on sending email"),o("Email sent successfully"))})},ie=async()=>{G.fire({icon:"info",title:"Are you sure?",showCancelButton:!0,showDenyButton:!0,confirmButtonText:"Send",denyButtonText:"Send With Attachment",denyButtonColor:"#000000",padding:"2em",customClass:{container:"sweet-alerts",denyButton:"btn btn-info "}}).then(async a=>{a.isConfirmed&&(o("Processing Sending Email"),(await c.quotationEmailProactive(i)).status!=200&&u("Problem on sending email"),o("Email sent successfully")),a.isDenied&&(o("Processing Sending Email"),(await c.quotationEmailProactive(i,!0)).status!=200&&u("Problem on sending email"),o("Email sent successfully"))})};n.useEffect(()=>{ae().then(()=>{Y(!1)})},[i]),n.useEffect(()=>{e.quote_file&&fe("quote","quote_file",e.quote_file).then(a=>{m(H({quote_file_preview:a}))})},[]);const p={leftObjects:[{label:"Converted By",value:`${e.converted_by?((S=e.converted_by)==null?void 0:S.first_name)+" "+((j=e.converted_by)==null?void 0:j.last_name):""}`},{label:"Customer RFQ No",value:e.customer_rfq_no},{label:"Quote Chance",value:`${e.quote_chance}`},{label:"Currency",value:`${e.currency}`}],rightObjects:[{label:"PM User",value:`${((O=e.pm_user)==null?void 0:O.first_name)??""} ${((k=e.pm_user)==null?void 0:k.last_name)??""}`},{label:"Deals Name",value:`${(C=e.deal)==null?void 0:C.deal_name}`},{label:"Quote Stage",value:`${e.quote_stage}`},{label:"Quote File(Excel)",value:t(_e,{formAttribute:"quote_file",modelName:"quote",formState:e})},{label:"Exchange Rate ",value:`${e.exchange_rate}`}]},g={leftObjects:[{label:"Quote valid",value:`${e.quote_valid}`},{label:"Proactive Offer",value:`${e.proactive_offer}`}],rightObjects:[{label:"Rating",value:`${e.rating}`}]},v={leftObjects:[{label:"Product Name",value:`${(x=e.product)==null?void 0:x.product_name}`},{label:"Customer part ID",value:`${e.customer_part_id}`}],rightObjects:[{label:"Quantity",value:`${e.quantity}`},{label:"List Price",value:`${e.list_price}`},{label:"Lead Time",value:`${e.lead_time}`}]},y={leftObjects:[{label:"Vendor",value:`${(N=e.vendor)==null?void 0:N.vendor_name}`},{label:"Availability No",value:`${e.availability_no}`},{label:"Availability Date",value:`${e.availability_date}`},{label:"Availability",value:`${(P=e.availability)==null?void 0:P.availability_name}`}],rightObjects:[{label:"Cost",value:`${e.cost}`},{label:"LT vendor",value:`${e.lt_vendor}`},{label:"SPQ",value:`${e.spq}`},{label:"Quantity in Stock",value:`${e.quantity_in_stock}`}]},_={leftObjects:[{label:"Billing Street",value:`${e.billing_street}`},{label:"Billing City",value:`${e.billing_city}`},{label:"Billing State",value:`${e.billing_state}`},{label:"Billing Code",value:`${e.billing_code}`},{label:"Billing Country",value:`${e.billing_country}`}],rightObjects:[{label:"Shipping Street",value:`${e.shipping_street}`},{label:"Shipping City",value:`${e.shipping_city}`},{label:"Shipping State",value:`${e.shipping_state}`},{label:"Shipping Code",value:`${e.shipping_code}`},{label:"Shipping Country",value:`${e.shipping_country}`}]},oe=[{key:"product_name",label:"Product Name",model:"product"},{key:"customer_part_id",label:"Customer Part ID"},{key:"quantity",label:"Quantity"},{key:"spq",label:"SPQ"},{key:"list_price",label:"List Price"},{key:"lead_time",label:"Lead Time"},{key:"date_code",label:"Date Code"},{key:"amount",label:"Amount"},{key:"comment",label:"Comment"}],se=[{label:"Account Name",value:`${((E=e.account)==null?void 0:E.account_name)??""} `},{label:"Contact Name",value:`${((q=e.contact)==null?void 0:q.first_name)??""} ${((D=e.contact)==null?void 0:D.last_name)??""} `},{label:"RFQ Name",value:`${((B=e.rfq)==null?void 0:B.rfq_name)??""} `},{label:"Subject",value:`${e.subject??""} `},{label:"Quote Owner",value:`${((I=e.owner)==null?void 0:I.first_name)??""} ${((L=e.owner)==null?void 0:L.last_name)??""}`},{label:"Created By",value:`${((A=e.creator)==null?void 0:A.first_name)??""} ${((Q=e.creator)==null?void 0:Q.last_name)??""}`},{label:"Modified By",value:`${((T=e.modifier)==null?void 0:T.first_name)??""} ${((M=e.modifier)==null?void 0:M.last_name)??""}`}],ne=[{label:"Subject",key:"subject"},{label:"Reciver Mail",key:"receiver_mail"},{label:"Sender Mail",key:"sender_email"},{label:"Sender Type",key:"sender_type"},{label:"Status",key:"status"},{label:"Created time",key:"created_at",format:a=>new Date(a).toISOString().split("T")[0]},{label:"Action",key:"action",render:a=>t("div",{onClick:()=>re(a),className:"flex hover:text-info",children:t(Se,{})})}];let w={leftObjects:[],rightObjects:[]};const re=a=>{var l,R,F,W,U,V;w={leftObjects:[{label:"Sender Name",value:`${(a.sender_name??"").substring(0,20)}${a.sender_name&&a.sender_name.length>15?"...":""}`},{label:"Is Open",value:`${a.is_open??""}`},{label:"Creator",value:`${((l=a.creator)==null?void 0:l.first_name)??""} ${((R=a.creator)==null?void 0:R.last_name)??""}`},{label:"Modifier",value:`${((F=a.modifier)==null?void 0:F.first_name)??""} ${((W=a.modifier)==null?void 0:W.last_name)??""}`},{label:"Mail Status",value:`${a.mail_status??""}`}],rightObjects:[{label:"Owner",value:`${((U=a.owner)==null?void 0:U.first_name)??""} ${((V=a.owner)==null?void 0:V.last_name)??""}`},{label:"Sent At",value:`${a.sent_at??""}`},{label:"Tracking Uuid",value:`${a.tracking_uuid??""}`},{label:"Type",value:`${a.type??""}`},{label:"Opened At",value:`${a.opened_at??""}`}]},ee(w),h(!0)},$=()=>{h(!1)};return d?t(z,{}):!f("read-quote")||d?t(z,{}):s("div",{children:[s("div",{className:"flex items-center lg:justify-end justify-center flex-wrap gap-4 mb-6",children:[t(ve,{loading:d,hasPermission:f,modelId:i,exportTable:te,routeModel:"quotes",permissionModel:"quote",hasDownloadPdf:!0}),s("button",{type:"button",className:"btn btn-info gap-2",onClick:le,children:[t(we,{}),"Quotation Email"]}),s("button",{type:"button",className:"btn btn-info gap-2",onClick:ie,children:[t($e,{}),"Quotation Proactive Email"]})]}),s("div",{className:"panel",children:[s("div",{className:"flex justify-between flex-wrap gap-4 px-4",children:[t("div",{className:"text-2xl font-semibold uppercase",children:"Quote"}),t("div",{className:"shrink-0",children:t("img",{src:he(e.image_data),alt:"Quote image",className:"w-20 ltr:ml-auto rtl:mr-auto"})})]}),t(ge,{data:se}),t("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),t(r,{title:"Header",leftObjects:p.leftObjects,rightObjects:p.rightObjects}),t("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),t(r,{title:"Status",leftObjects:g.leftObjects,rightObjects:g.rightObjects}),t("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),t(K,{title:"Quote Items",items:e.items,columns:oe,total:e.quote_total}),t("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),t(r,{title:"Quote Line",leftObjects:v.leftObjects,rightObjects:v.rightObjects}),t("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),t(r,{title:"Source",leftObjects:y.leftObjects,rightObjects:y.rightObjects}),t("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),t(r,{title:"Address Information",leftObjects:_.leftObjects,rightObjects:_.rightObjects}),t("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),t(J,{sectionTitle:"Terms And Conditions",data:[{label:"Terms and Conditions",value:e.terms_and_conditions}]}),t("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),t(J,{sectionTitle:"Description ",data:[{label:"Description",value:e.description}]}),t("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),t(r,{title:"Date information",leftObjects:[{label:"Created Date",value:X(e.created_at)}],rightObjects:[{label:"Modified Date",value:X(e.updated_at)}]}),t("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),t(ye,{modelId:i,modelName:"quote"}),t("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),t(K,{title:"Email Logs",items:e.emaillogs,columns:ne}),Z&&b&&s("div",{className:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 p-8 bg-white shadow-md rounded z-50 border  shadow-gray-300",children:[t("div",{className:"absolute top-2 right-2 cursor-pointer",onClick:$,children:t("svg",{className:"w-6 h-6 text-gray-600 hover:text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:t("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),t(je,{title:"Email Log",leftObjects:b.leftObjects,rightObjects:b.rightObjects}),t("div",{className:"mt-auto px-2 py-3 sm:flex sm:flex-row-reverse sm:px-3 my-5",children:t("button",{className:"fixed bottom-5 w-full justify-center rounded-md bg-red-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-red-500 sm:ml-3 sm:w-auto",onClick:$,children:"Close"})})]})]})]})};export{Le as default};
