import{u as E,d as A,a as te,r as x,j as e,A as y,a0 as U,b as n,F as p,x as v,a1 as ne,aT as ce,aS as g,S as se,v as oe,f as H,G as ie,n as de,t as G,aD as me,h as re,c as ue,T as pe,s as he,aU as z,e as J,W as fe}from"./main-df5dc7ed.js";/* empty css                  */import{G as Q}from"./GenerateFields-3c7eab22.js";import{L as K}from"./LoadingSpinner-c2ffda38.js";import{F as O}from"./index-948d32bd.js";import{T as be}from"./tippy-react.esm-e43bb4a7.js";import{S as F}from"./react-select.esm-9f2a3f32.js";import{F as xe}from"./FileUploadComponent-5d2a0917.js";import{R as X,M as Z,N as ee,O as ae}from"./SelectOptions-b97727f8.js";import{A as _e}from"./AttachmentSection-2b18bb8f.js";import{A as ye}from"./ActionButtonsComponent-1d92025d.js";import"./ClearButtonComponent-638f0936.js";import"./index-e120b408.js";const k=h=>{const a=new Date(h),l=a.getFullYear(),f=String(a.getMonth()+1).padStart(2,"0"),c=String(a.getDate()).padStart(2,"0");return`${l}:${f}:${c}`},ve=()=>{var M,$,P,Y,j,L,I,W,B;const h=E(),a=A(s=>s.rfqFormSlice),l=new te,[f,c]=x.useState(!1),[b,q]=x.useState({web:[],nonWeb:[]}),[N,C]=x.useState({matched:[]}),[w,S]=x.useState(null),d=(s="",o="success")=>{se.mixin({toast:!0,position:"top",showConfirmButton:!1,timer:3e3,customClass:{container:"toast"}}).fire({icon:o,title:s,padding:"10px 20px"})},_=(s,o)=>{navigator.clipboard.writeText(s),S(o),d("Copied to clipboard!")},D=({suggestions:s,loading:o})=>n(p,{children:[e("h3",{className:"text-xl",children:"Availability Suggestions :"}),n("table",{className:"min-w-full bg-white border border-gray-300",children:[e("thead",{children:n("tr",{children:[e("th",{className:"py-2 px-4 border-b",children:"Availability"}),e("th",{className:"py-2 px-4 border-b",children:"Availability Source"}),e("th",{className:"py-2 px-4 border-b",children:"Availability Cost"}),e("th",{className:"py-2 px-4 border-b",children:"Availability Created Date"}),e("th",{className:"py-2 px-4 border-b",children:"Actions"})]})}),o?e(K,{}):n("tbody",{children:[s.web.map((r,m)=>n("tr",{className:m%2===0?"bg-gray-100":"",children:[e("td",{className:"py-2 px-4 border-b",children:r.availability_name}),e("td",{className:"py-2 px-4 border-b",children:r.availability_source}),n("td",{className:"py-2 px-4 border-b",children:[r.cost," ",r.currency]}),e("td",{className:"py-2 px-4 border-b",children:k(r.created_at)}),e("td",{className:"py-2 px-4 border-b",children:e("button",{className:"btn btn-sm",onClick:()=>_(r.availability_name,m),children:"Copy to Clipboard"})})]},m)),s.nonWeb.map((r,m)=>n("tr",{className:m%2===0?"bg-gray-100":"",children:[e("td",{className:"py-2 px-4 border-b",children:r.availability_name}),e("td",{className:"py-2 px-4 border-b",children:r.availability_source}),n("td",{className:"py-2 px-4 border-b",children:[r.cost," ",r.currency]}),e("td",{className:"py-2 px-4 border-b",children:k(r.created_at)})]},m))]})]})]}),R=({suggestions:s,loading:o})=>n(p,{children:[e("h3",{className:"text-xl mt-4",children:"Excess Suggestions :"}),n("table",{className:"min-w-full bg-white border border-gray-300",children:[e("thead",{children:n("tr",{children:[e("th",{className:"py-2 px-4 border-b",children:"Excess Name"}),e("th",{className:"py-2 px-4 border-b",children:"Excess Source"}),e("th",{className:"py-2 px-4 border-b",children:"Excess No"}),e("th",{className:"py-2 px-4 border-b",children:"Excess Cost"}),e("th",{className:"py-2 px-4 border-b",children:"Excess Type"}),e("th",{className:"py-2 px-4 border-b",children:"Excess Quantity"}),e("th",{className:"py-2 px-4 border-b",children:"Excess Created Date"}),e("th",{className:"py-2 px-4 border-b",children:"Actions"})]})}),o?e(K,{}):e("tbody",{children:s.matched.map((r,m)=>n("tr",{className:m%2===0?"bg-gray-100":"",children:[e("td",{className:"py-2 px-4 border-b",children:r.excess_name}),e("td",{className:"py-2 px-4 border-b",children:r.excess_source}),e("td",{className:"py-2 px-4 border-b",children:r.excess_no}),n("td",{className:"py-2 px-4 border-b",children:[r.cost," ",r.currency]}),e("td",{className:"py-2 px-4 border-b",children:r.excess_type}),e("td",{className:"py-2 px-4 border-b",children:r.quantity}),e("td",{className:"py-2 px-4 border-b",children:k(r.created_at)}),e("td",{className:"py-2 px-4 border-b",children:e("button",{className:"btn btn-sm",onClick:()=>_(r.excess_name,m),children:"Copy to Clipboard"})})]},m))})]})]}),u=(s,o)=>{h(g({[s]:o})),s==="product_id"&&(t(o),i(o))},V=s=>{h(g({availability_id:s}))},T={"RFQ Line":{"Product Name":e(y,{defaultOptions:!0,isMulti:!1,id:"product_id",placeholder:"Type at least 2 characters to search...",loadOptions:U,onChange:({value:s})=>{u("product_id",s)},defaultValue:{value:(M=a.product)==null?void 0:M.id,label:e("div",{className:"flex items-center",children:a.product?n(p,{children:[e("div",{className:"text-sm font-bold",children:($=a.product)==null?void 0:$.product_name}),e("button",{className:"btn text-xs btn-sm ml-auto",onClick:()=>{var s;return v(`${(s=a.product)==null?void 0:s.product_name}`)},children:"Copy & Select"})]}):null},(P=a.product)==null?void 0:P.id)},className:"flex-1",required:!0}),"Customer Part Id":e("input",{id:"customer_part_id",name:"customer_part_id",className:"form-input flex-1 ",defaultValue:a.customer_part_id,onChange:s=>u(s.target.name,s.target.value)}),Quantity:e("input",{id:"quantity",name:"quantity",className:"form-input flex-1 ",defaultValue:a.quantity,onChange:s=>u(s.target.name,s.target.value),required:!0}),"Target Price":e("input",{id:"target_price",name:"target_price",defaultValue:a.target_price,onChange:s=>u(s.target.name,s.target.value),className:"form-input flex-1 "})},"":{"Alternative Products":e(y,{defaultOptions:!0,id:"alternative_products",name:"alternative_products",placeholder:"Type at least 2 characters to search...",loadOptions:U,onChange:s=>{u("alternative_products",s.map(o=>o.value))},isMulti:!0,defaultValue:a.rfq_product_alternatives?a.rfq_product_alternatives.map(s=>({value:s.id,label:e("div",{className:"flex items-center",children:n(p,{children:[e("div",{className:"text-sm font-bold",children:s.product_name}),e("button",{className:"btn text-xs btn-sm ml-auto",onClick:()=>v(`${s.product_name}`),children:"Copy & Select"})]})},s.id)})):[],className:"flex-1"}),Availability:e(y,{defaultOptions:!0,isMulti:!1,id:"availability",name:"availability_id",placeholder:"Type at least 2 characters to search...",loadOptions:ne,onChange:({value:s})=>{u("availability_id",s)},defaultValue:{value:(Y=a.availability)==null?void 0:Y.id,label:e("div",{className:"flex items-center",children:a.availability?n(p,{children:[e("div",{className:"text-sm font-bold",children:(j=a.availability)==null?void 0:j.availability_name}),e("button",{className:"btn text-xs btn-sm ml-auto",onClick:()=>{var s;return v(`${(s=a.availability)==null?void 0:s.availability_name}`)},children:"Copy & Select"})]}):null},(L=a.availability)==null?void 0:L.id)},className:"flex-1"}),Excess:e(y,{defaultOptions:!0,isMulti:!1,id:"excess_id",name:"excess_id",placeholder:"Type at least 2 characters to search...",loadOptions:ce,onChange:({value:s})=>{u("excess_id",s)},defaultValue:{value:(I=a.excess)==null?void 0:I.id,label:e("div",{className:"flex items-center",children:a.excess?n(p,{children:[e("div",{className:"text-sm font-bold",children:(W=a.excess)==null?void 0:W.excess_name}),e("button",{className:"btn text-xs btn-sm ml-auto",onClick:()=>{var s;return v(`${(s=a.excess)==null?void 0:s.excess_name}`)},children:"Copy & Select"})]}):null},(B=a.excess)==null?void 0:B.id)},className:"flex-1"}),"Special Instructions":e("textarea",{id:"special_instructions",name:"special_instructions",rows:3,defaultValue:a.special_instructions,onChange:s=>u(s.target.name,s.target.value),className:"form-textarea flex-1"}),comment:e("textarea",{id:"comment",rows:3,name:"comment",className:"form-textarea flex-1",defaultValue:a.comment,onChange:s=>u(s.target.name,s.target.value),placeholder:""})}},t=async s=>{try{c(!0);const o=await l.fetchSuggestedAvailability(s);if(o.status===200){const r=o.data.data,m=r.web?[r.web]:[],le=r.nonWeb?[r.nonWeb]:[];q({web:m,nonWeb:le})}}catch(o){c(!1),console.error("Error fetching availability suggestions:",o)}finally{c(!1)}},i=async s=>{try{c(!0);const o=await l.fetchSuggestedExcess(s);if(o.status===200){const r=o.data.data,m=r.matched?[r.matched]:[];C({matched:m})}}catch(o){c(!1),console.error("Error fetching excess suggestions:",o)}finally{c(!1)}};return x.useEffect(()=>{t(a.product_id),i(a.product_id)},[]),n(p,{children:[e("div",{className:"flex justify-between lg:flex-row flex-col",children:e(Q,{fields:T})}),e(D,{loading:f,suggestions:b,onAvailabilitySelect:V}),e(R,{loading:f,suggestions:N})]})},Ne=()=>{const h=E(),a=A(c=>c.rfqFormSlice),l=(c,b)=>{h(g({[c]:b}))},f={Development:{"Processed for VRFQ round 1":e(be,{content:"Please do not change the value",className:"red",children:e("input",{id:"processed_for_vrfq_round_1",type:"checkbox",name:"processed_for_vrfq_round_1",className:"form-checkbox",onChange:c=>l(c.target.name,c.target.checked),checked:a.processed_for_vrfq_round_1=="true"})}),"Processed for VRFQ round 2":e("label",{className:"flex items-center cursor-pointer",children:e("input",{id:"processed_for_vrfq_round_2",type:"checkbox",name:"processed_for_vrfq_round_2",className:"form-checkbox",onChange:c=>l(c.target.name,c.target.checked),checked:a.processed_for_vrfq_round_2=="true"})}),"Open Status Time":e(O,{name:"open_status_timestamp","data-enable-time":!0,options:{enableTime:!0,dateFormat:"Y-m-d H:i",position:"auto left"},defaultValue:a.open_status_timestamp,onChange:(c,b)=>l("open_status_timestamp",b),className:"form-input flex-1"})}};return e(p,{children:e("div",{className:"flex justify-between lg:flex-row flex-col",children:e(Q,{fields:f})})})},ge=()=>{var c,b,q,N,C,w,S,d,_,D,R,u,V,T;const h=E(),a=A(t=>t.rfqFormSlice),l=(t,i)=>{h(g({[t]:i}))},f={Header:{"Account Name":e(y,{defaultOptions:!0,isMulti:!1,id:"account_id",name:"account_id",placeholder:"Type at least 2 characters to search...",loadOptions:oe,onChange:({value:t})=>{l("account_id",t)},defaultValue:{value:(c=a.account)==null?void 0:c.id,label:e("div",{className:"flex items-center",children:a.account?n(p,{children:[e("img",{src:H(a.account.image),alt:"avatar",className:"w-8 h-8 mr-2 rounded-full"}),n("div",{children:[e("div",{className:"text-sm font-bold",children:(b=a.account)==null?void 0:b.account_name}),e("div",{className:"text-xs text-gray-500",children:(q=a.account)==null?void 0:q.email})]}),e("button",{className:"btn text-xs btn-sm ml-auto",onClick:()=>{var t;return v(`${(t=a.account)==null?void 0:t.account_name}`)},children:"Copy & Select"})]}):null},(N=a.account)==null?void 0:N.id)},className:"flex-1"}),Contact:e(y,{defaultOptions:!0,isMulti:!1,id:"contact",name:"contact_id",placeholder:"Type at least 2 characters to search...",loadOptions:ie,onChange:({value:t})=>{l("contact_id",t)},defaultValue:{value:(C=a.contact)==null?void 0:C.id,label:e("div",{className:"flex items-center",children:a.contact?n(p,{children:[e("img",{src:a.contact.image??"/assets/images/user-profile.jpeg",alt:"avatar",className:"w-8 h-8 mr-2 rounded-full"}),n("div",{children:[e("div",{className:"text-sm font-bold",children:((w=a.contact)==null?void 0:w.first_name)+" "+((S=a.contact)==null?void 0:S.last_name)}),e("div",{className:"text-xs text-gray-500",children:(d=a.contact)==null?void 0:d.email})]}),e("button",{className:"btn text-xs btn-sm ml-auto",onClick:()=>{var t,i;return v(`${((t=a.contact)==null?void 0:t.first_name)+" "+((i=a.contact)==null?void 0:i.last_name)}`)},children:"Copy & Select"})]}):null},(_=a.contact)==null?void 0:_.id)},className:"flex-1"}),"Customer RFQ No":e("input",{id:"customer_rfq_no",name:"customer_rfq_no",className:"form-input flex-1 ",defaultValue:a.customer_rfq_no,onChange:t=>l(t.target.name,t.target.value)}),"Project Name / Application":e("input",{id:"project_name",name:"project_name",className:"form-input flex-1 ",defaultValue:a.project_name,onChange:t=>l(t.target.name,t.target.value)}),"RFQ Source":e(F,{name:"rfq_source",required:!0,options:X,onChange:({value:t})=>{l("rfq_source",t)},defaultValue:a.rfq_source?X.find(t=>t.value==a.rfq_source):{value:"none",label:"-None-"},className:"flex-1"}),"RFQ Type":e(F,{name:"rfq_type",required:!0,options:Z,onChange:({value:t})=>{l("rfq_type",t)},defaultValue:a.rfq_type?Z.find(t=>t.value==a.rfq_type):{value:"none",label:"-None-"},className:"flex-1"}),Status:e(F,{name:"status",required:!0,options:ee,onChange:({value:t})=>{l("status",t)},defaultValue:a.status?ee.find(t=>t.value==a.status):{value:"Open",label:"Open"},className:"flex-1"}),"Date History":e(O,{name:"date_history",options:{dateFormat:"Y-m-d ",defaultDate:a.date_history?new Date(a.date_history):null},defaultValue:a.date_history,className:"form-input flex-1",placeholder:"YYYY-MM-DD",onChange:(t,i)=>l("date_history",i)}),"Exchange Rate":e("input",{id:"exchangeRate",type:"text",value:"1",placeholder:"readOnly input hereâ€¦",className:"flex-1 form-input disabled:pointer-events-none disabled:bg-[#eee] dark:disabled:bg-[#1b2e4b] cursor-not-allowed",disabled:!0}),"Portal BOM id":e("input",{id:"portal_bom_id",name:"portal_bom_id",onChange:t=>l(t.target.name,t.target.value),defaultValue:a.portal_bom_id,className:"form-input flex-1 "})},"":{"RFQ Owner":e(y,{defaultOptions:!0,isMulti:!1,id:"owner_id",placeholder:"Type at least 2 characters to search...",loadOptions:de,onChange:({value:t})=>{l("owner_id",t)},defaultValue:{value:(D=a.owner)==null?void 0:D.id,label:e("div",{className:"flex items-center",children:a.owner?n(p,{children:[e("img",{src:H(a.owner.avatar_data),alt:"avatar",className:"w-8 h-8 mr-2 rounded-full"}),n("div",{children:[e("div",{className:"text-sm font-bold",children:((R=a.owner)==null?void 0:R.first_name)+" "+((u=a.owner)==null?void 0:u.last_name)}),e("div",{className:"text-xs text-gray-500",children:(V=a.owner)==null?void 0:V.email})]}),e("button",{className:"btn text-xs btn-sm ml-auto",onClick:()=>{var t,i;return v(`${((t=a.owner)==null?void 0:t.first_name)+" "+((i=a.owner)==null?void 0:i.last_name)}`)},children:"Copy & Select"})]}):null},(T=a.owner)==null?void 0:T.id)},className:"flex-1"}),"Deal Stage":e(F,{name:"deal_stage",options:ae,onChange:({value:t})=>{l("deal_stage",t)},defaultValue:ae.find(t=>t.value==a.deal_stage),className:"flex-1"}),"Customer RFQ File":e(xe,{id:"customer_rfq_file",modelName:"rfq",formState:a,formAttribute:"customer_rfq_file",updateFormData:g}),"RFQ Dead Line":e(O,{name:"rfq_dead_line",options:{dateFormat:"Y-m-d ",defaultDate:a.rfq_dead_line?new Date(a.rfq_dead_line):null},defaultValue:a.rfq_dead_line,className:"form-input flex-1",placeholder:"YYYY-MM-DD",onChange:(t,i)=>l("rfq_dead_line",i)}),Currency:e(F,{name:"currency",id:"currency",options:G,className:"flex-1",onChange:({value:t})=>{l("currency",t)},defaultValue:G.find(t=>t.value==a.currency)}),"Vendor RFQs Line":e(y,{defaultOptions:!0,id:"vendor_rfqs_line",name:"vendor_rfqs_line",placeholder:"Type at least 2 characters to search...",loadOptions:me,onChange:t=>{l("vendor_rfqs_lines",t.map(i=>i.value))},defaultValue:a.vendor_rfqs_line?a.vendor_rfqs_line.map(t=>({value:t.id,label:e("div",{className:"flex items-center",children:n("div",{children:[e("div",{className:"text-sm font-bold",children:t.vendor_name}),e("button",{className:"btn text-xs btn-sm ml-auto",onClick:()=>v(`${t.vendor_name}`),children:"Copy & Select"})]})},t.id)})):[],isMulti:!0,className:"flex-1"})}};return e(p,{children:e("div",{className:"flex justify-between lg:flex-row flex-col",children:e(Q,{fields:f})})})},Ce=()=>{const a=re().id;return n("div",{className:"mt-8 px-4",children:[e(ge,{}),e("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),e(ve,{}),e("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),e(Ne,{}),e("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),e(_e,{modelId:a,modelName:"rfq"})]})},Me=()=>{const{hasPermission:h}=ue(),a=A(d=>d.rfqFormSlice),l=E(),f=new te,[c,b]=x.useState(!0),N=re().id,C=pe();x.useEffect(()=>{l(he("RFQ Edit"))}),x.useEffect(()=>{l(z())},[]),x.useEffect(()=>{w().then(()=>{b(!1)})},[N]),x.useEffect(()=>{l(g({api:"updateSingleRfq",redirectTo:"/rfq/edit/:id",action:"edit"}))},[]);const w=async()=>{const d=await f.fetchSingleRfq(N);if(d.status!=200)return;const _=d.data.data.rfq;l(g(_))};if(c)return e(J,{});const S=async()=>{try{const d=await f.convertRfqToQuote({id:a.id});se.fire({title:"Rfq Converted Successfully.",html:`
                <span class="text-blue-500">Do you want to redirect to created Quote ? </span>
                `,showCancelButton:!0,icon:"success",confirmButtonText:"Redirect",denyButtonText:"Close",customClass:{title:"text-blue-500"}}).then(_=>{_.isConfirmed&&C(`/quotes/edit/${d.data.quote.id}`,{replace:!0})})}catch(d){fe("Failed to convert Rfq"),console.error(d);return}};return!h("update-rfq")||c?e(J,{}):n("div",{className:"px-4",children:[e(ye,{formState:a,resetForm:z}),e("div",{className:"flex xl:flex-row flex-col gap-2.5",children:n("div",{className:"panel px-0 flex-1 py-6 ltr:xl:mr-6 rtl:xl:ml-6",children:[e("button",{onClick:S,className:"mx-5 btn btn-secondary gap-2",children:"Convert RFQ to Quote"}),e(Ce,{})]})})]})};export{Me as default};
