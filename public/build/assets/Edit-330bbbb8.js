import{u as k,a as F,b as e,j as r,F as w,aa as y,r as f,e as $,s as z,ab as L}from"./main-fcf5e4ad.js";import{A as j,a as M}from"./react-select-async.esm-8b244106.js";import{s as q,b as G,j as Q,v as A,d as U,a as O,G as B,m as Y,c as W}from"./CommonFunctions-c9f08edc.js";import{F as R}from"./index-7af546ea.js";import{S as D}from"./react-select.esm-cf3be803.js";import{k as E,E as Z}from"./EditPencilIcon-8fd90c6e.js";import{$ as H}from"./transition-9b85e0fc.js";import{L as J}from"./LoadingAlpyn-be0f6e79.js";/* empty css                  */import"./Select-aecb2a80.esm-5ec404e0.js";import"./sweetalert2.all-b010eac4.js";import"./use-is-mounted-4e523195.js";import"./use-resolve-button-type-c4b37f3d.js";const K=()=>{var d,p,c,g,x,b,v,_,t,u,l,h,N,C,S,V,P;const m=k(),a=F(s=>s.invoiceForm),o=(s,I)=>{m(y({[s]:I}))},i=[{value:"erzeugt",label:"Erzeugt"},{value:"genehmigt",label:"Genehmigt"},{value:"geliefert",label:"Geliefert"},{value:"abgesagt",label:"Abgesagt"}],n={"Invoice Information":{"Invoice Owner":e(j,{isMulti:!1,id:"owner_id",name:"owner_id",placeholder:"Type at least 2 characters to search...",loadOptions:q,className:"flex-1",onChange:({value:s})=>{o("owner_id",s)},defaultValue:{value:(d=a.owner)==null?void 0:d.id,label:r("div",{className:"flex items-center",children:[e("img",{src:(p=a.owner)==null?void 0:p.avatar,alt:"avatar",className:"w-8 h-8 mr-2 rounded-full"}),r("div",{children:[e("div",{className:"text-sm font-bold",children:(c=a.owner)==null?void 0:c.name}),e("div",{className:"text-xs text-gray-500",children:(g=a.owner)==null?void 0:g.email})]})]},(x=a.owner)==null?void 0:x.id)}}),Subject:e("input",{id:"subject",required:!0,name:"subject",className:"form-input flex-1 ",onChange:s=>o(s.target.name,s.target.value),defaultValue:a.subject}),"Invoice Date":e(R,{options:{dateFormat:"Y-m-d",position:"auto left",defaultDate:`${a.invoice_date?new Date(a.invoice_date):""}`},value:a.invoice_date,className:"form-input flex-1",name:"invoice_date",onChange:(s,I)=>o("invoice_date",I)}),"Due Date":e(R,{options:{dateFormat:"Y-m-d",position:"auto left",defaultDate:`${a.due_date?new Date(a.due_date):""}`},value:a.invoice_date,name:"due_date",className:"form-input flex-1",onChange:(s,I)=>o("due_date",I)}),"Sales Commission":e("input",{id:"sales_commission",name:"sales_commission",defaultValue:a.sales_commission,className:"form-input flex-1 ",onChange:s=>o(s.target.name,s.target.value)}),"Account Name":e(j,{isMulti:!1,id:"account_id",placeholder:"Type at least 2 characters to search...",name:"account_id",loadOptions:G,onChange:({value:s})=>{o("account_id",s)},className:"flex-1",defaultValue:{value:(b=a.account)==null?void 0:b.id,label:r("div",{className:"flex items-center",children:[e("img",{src:(v=a.account)==null?void 0:v.image,alt:"avatar",className:"w-8 h-8 mr-2 rounded-full"}),r("div",{children:[e("div",{className:"text-sm font-bold",children:(_=a.account)==null?void 0:_.name}),e("div",{className:"text-xs text-gray-500",children:(t=a.account)==null?void 0:t.email})]})]},(u=a.account)==null?void 0:u.id)}}),"Exchange Rate":e("input",{id:"exchangeRate",type:"text",value:"1",placeholder:"Readonly input here…",className:"flex-1 form-input disabled:pointer-events-none disabled:bg-[#eee] dark:disabled:bg-[#1b2e4b] cursor-not-allowed",disabled:!0}),ZohoBooksID:e("input",{id:"zoho_books_id",name:"zoho_books_id",defaultValue:a.zoho_books_id,className:"form-input flex-1 ",onChange:s=>o(s.target.name,s.target.value)})},"":{"Sales Order":e(j,{isMulti:!1,id:"sales_order_id",placeholder:"Type at least 2 characters to search...",name:"sales_order_id",loadOptions:Q,onChange:({value:s})=>{o("sales_order_id",s)},defaultValue:{value:(l=a.sales_order)==null?void 0:l.id,label:e("div",{className:"flex items-center",children:e("div",{className:"text-sm font-bold",children:(h=a.sales_order)==null?void 0:h.subject})},(N=a.sales_order)==null?void 0:N.id)},className:"flex-1"}),"Purchase Order":e("input",{id:"purchase_order",name:"purchase_order",className:"form-input flex-1 ",defaultValue:a.purchase_order,onChange:s=>o(s.target.name,s.target.value)}),"Deal Stage":e(D,{name:"deal_stage",id:"deal_stage",placeholder:"",options:A,defaultValue:A.find(s=>s.value==a.deal_stage),onChange:({value:s})=>{o("deal_stage",s)}}),"Excise Duty":e("input",{id:"excise_duty",name:"excise_duty",className:"form-input flex-1 ",defaultValue:a.excise_duty,onChange:s=>o(s.target.name,s.target.value)}),Status:e(D,{name:"status",id:"status",placeholder:"",options:i,onChange:({value:s})=>{o("status",s)},defaultValue:i.find(s=>s.value==a.status)}),"Contact Name":e(j,{isMulti:!1,id:"contact_id",placeholder:"Type at least 2 characters to search...",name:"contact_id",loadOptions:U,onChange:({value:s})=>{o("contact_id",s)},defaultValue:{value:(C=a.contact)==null?void 0:C.id,label:e("div",{className:"flex items-center",children:r("div",{className:"text-sm font-bold",children:[(S=a.contact)==null?void 0:S.first_name," ",(V=a.contact)==null?void 0:V.last_name]})},(P=a.contact)==null?void 0:P.id)},className:"flex-1"}),Currency:e(D,{id:"currency",name:"currency",options:O,defaultValue:O.find(s=>s.value==a.currency),className:"flex-1"})}};return e(w,{children:e("div",{className:"flex justify-between lg:flex-row flex-col",children:e(B,{fields:n})})})},X=()=>{const m=k(),a=F(n=>n.invoiceForm),o=(n,d)=>{m(y({[n]:d}))},i={"Address Information":{"Billing Street":e("input",{id:"billing_street",name:"billing_street",onChange:n=>o(n.target.name,n.target.value),defaultValue:a.billing_street,className:"form-input flex-1"}),"Billing City":e("input",{id:"billing_city",name:"billing_city",defaultValue:a.billing_city,onChange:n=>o(n.target.name,n.target.value),className:"form-input flex-1"}),"Billing State":e("input",{id:"billing_state",name:"billing_state",defaultValue:a.billing_state,onChange:n=>o(n.target.name,n.target.value),className:"form-input flex-1"}),"Billing Code":e("input",{id:"billing_code",name:"billing_code",defaultValue:a.billing_code,onChange:n=>o(n.target.name,n.target.value),className:"form-input flex-1"}),"Billing Country":e("input",{id:"billing_country",name:"billing_country",defaultValue:a.billing_country,onChange:n=>o(n.target.name,n.target.value),className:"form-input flex-1"})},"":{"Shipping Street":e("input",{id:"shipping_street",name:"shipping_street",defaultValue:a.shipping_street,onChange:n=>o(n.target.name,n.target.value),className:"form-input flex-1"}),"Shipping City":e("input",{id:"shipping_city",name:"shipping_city",defaultValue:a.shipping_city,onChange:n=>o(n.target.name,n.target.value),className:"form-input flex-1"}),"Shipping State":e("input",{id:"shipping_state",name:"shipping_state",defaultValue:a.shipping_state,onChange:n=>o(n.target.name,n.target.value),className:"form-input flex-1"}),"Shipping Code":e("input",{id:"shipping_code",name:"shipping_code",defaultValue:a.shipping_code,onChange:n=>o(n.target.name,n.target.value),className:"form-input flex-1"}),"Shipping Country":e("input",{id:"shipping_country",name:"shipping_country",defaultValue:a.shipping_country,onChange:n=>o(n.target.name,n.target.value),className:"form-input flex-1"})}};return e(w,{children:e("div",{className:"flex justify-between lg:flex-row flex-col",children:e(B,{fields:i})})})},T=({item:m,field:a,handleChangeField:o})=>{const[i,n]=f.useState(!0),d=f.useRef(null),p=f.useRef(null),c=f.useRef(null),g=()=>{n(b=>!b)},x=()=>{var v,_,t;let b;i?b=(p.current?parseFloat((v=p.current)==null?void 0:v.value):0)/100*m.amount:b=c.current?parseFloat((_=c.current)==null?void 0:_.value):0,o(a,b,m.id),(t=d.current)==null||t.click()};return e(w,{children:e(E,{className:"relative",children:({open:b})=>r(w,{children:[e(E.Button,{ref:d,className:"btn w-5 h-5 p-0 rounded-full ml-1",children:e(Z,{})}),e(H,{as:f.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:e(E.Panel,{className:"absolute left-1/2 z-10 mt-3  max-w-sm -translate-x-1/2 transform px-4 sm:px-0 w-80",children:e("div",{className:"overflow-hidden rounded-lg shadow-lg ring-1 ring-black ring-opacity-5 ",children:r("div",{className:"relative grid gap-8 bg-white p-7 w-full",children:[r("div",{className:"flex gap-3",children:[r("label",{className:"inline-block",children:[e("input",{checked:i,type:"radio",name:"type",className:"form-radio",onChange:g}),e("span",{children:"Percentage"})]}),e("input",{name:"total",ref:p,hidden:!i,className:"form-input mx-2 w-20  h-8  cursor-text"})]}),r("div",{className:"block gap-3",children:[r("label",{className:"inline-block",children:[e("input",{checked:!i,type:"radio",name:"type",className:"form-radio",onChange:g}),e("span",{className:"",children:"Direct Price Reduction"})]}),e("input",{ref:c,name:"total",hidden:i,className:"form-input mx-2 w-20 h-8 cursor-text"})]}),r("div",{className:"flex gap-3",children:[e("button",{className:"btn btn-primary",onClick:x,children:"Submit"}),e("button",{className:"btn btn-warning",onClick:()=>{var v;return(v=d.current)==null?void 0:v.click()},children:"Cancel"})]})]})})})})]})})})},ee=()=>{const m=F(t=>t.invoiceForm),a=k(),o={amount:0,subtotal:0,discount:0,tax:0,adjustment:0,grandTotal:0},[i,n]=f.useState({defaultSummary:o,...m.summary}),[d,p]=f.useState([]);f.useEffect(()=>{p(Object.values(m.items))},[]);const c=(t,u,l)=>{const h={...d.find(S=>S.id===l)};h[t]=u;const N=(parseFloat(h.quantity)||0)*(parseFloat(h.list_price)||0),C=N-((parseFloat(h.discount)||0)+(parseFloat(h.tax)||0));h.amount=N,h.total=C,g(h)},g=t=>{const u=d.map(l=>l.id===t.id?{...l,...t}:l);p(u),a(y({items:u}))},x=()=>{let t;t=d!=null&&d.length?d.reduce((u,l)=>l.id>u?l.id:u,d[0].id):0,p([...d,{id:t+1,product_id:null,description:null,quantity:null,list_price:null,amount:null,discount:null,tax:null,total:null}])},b=(t,u)=>{const l={...i};l[t]=parseFloat(u),l.grandTotal=l.subtotal-l.discount+l.tax+l.adjustment,n(l)};f.useEffect(()=>{a(y({summary:i}))},[i]);const v=(t=null)=>{p(d.filter(u=>u.id!==t.id))},_=()=>{const t=d.reduce((S,V)=>S+(parseFloat(V.total)||0),0),u=t,l=i.discount,h=i.tax,N=i.adjustment,C=t-l+h+N;n({amount:u,subtotal:t,discount:l,tax:h,adjustment:N,grandTotal:C})};return f.useEffect(()=>{_()},[d]),e(w,{children:e("div",{className:"flex justify-between lg:flex-row flex-col",children:e("div",{className:" w-full ltr:lg:mr-12 rtl:lg:ml-12 mb-12",children:r("div",{className:"",children:[e("div",{className:"text-lg",children:"Invoice Items :"}),r("div",{className:"mt-8",children:[e("div",{className:"overflow-x",children:r("table",{className:"table-auto overflow-scroll w-full",children:[e("thead",{children:r("tr",{children:[e("th",{className:"w-1",children:"S.NO"}),e("th",{className:"w-full",children:"Product Name"}),e("th",{className:"w-1",children:"Quantity"}),e("th",{className:"w-1",children:"List Price"}),e("th",{className:"w-1",children:"Amount"}),e("th",{className:"w-1",children:"Discount"}),e("th",{className:"w-1",children:"Tax"}),e("th",{className:"w-1",children:"Total"})]})}),e("tbody",{children:d.map(t=>{var u;return r("tr",{className:"align-top",children:[e("td",{children:t.id}),r("td",{children:[e(j,{isMulti:!1,id:"product_id",name:"product_id",placeholder:"Type at least 2 characters to search...",loadOptions:Y,onChange:({value:l})=>{c("product_id",l,t.id)},className:"flex-1  min-w-[200px]",defaultValue:{value:t.id,label:e("div",{className:"flex items-center",children:e("div",{children:e("div",{className:"text-sm font-bold",children:(u=t.product)==null?void 0:u.product_name})})},t.id)}}),e("textarea",{name:"description",className:"form-textarea mt-4 flex-1",placeholder:"Enter Description",defaultValue:t.description,onChange:l=>c(l.target.name,l.target.value,t.id)})]}),e("td",{children:e("input",{name:"quantity",type:"text",className:"form-input min-w-[200px]",defaultValue:t.quantity,onChange:l=>c(l.target.name,l.target.value,t.id)})}),e("td",{children:e("input",{type:"number",className:"form-input w-32",placeholder:"Price",name:"list_price",min:0,defaultValue:t.list_price,onChange:l=>c(l.target.name,l.target.value,t.id)})}),e("td",{children:e("input",{name:"amount",type:"number",className:"form-input min-w-[200px]  form-input disabled:pointer-events-none bg-[#eee] dark:bg-[#1b2e4b]  cursor-text",value:t.amount,disabled:!0,onChange:l=>c(l.target.name,l.target.value,t.id)})}),e("td",{children:r("div",{className:"flex",children:[e("input",{name:"discount",type:"number",className:"form-input min-w-[200px]  form-input disabled:pointer-events-none bg-[#eee] dark:bg-[#1b2e4b]  cursor-text",value:t.discount,disabled:!0,onChange:l=>c(l.target.name,l.target.value,t.id)}),e(T,{item:t,handleChangeField:c,field:"discount"})]})}),e("td",{children:r("div",{className:"flex",children:[e("input",{name:"tax",type:"number",className:"form-input min-w-[200px]  form-input disabled:pointer-events-none bg-[#eee] dark:bg-[#1b2e4b]  cursor-text",value:t.tax,disabled:!0,onChange:l=>c(l.target.name,l.target.value,t.id)}),e(T,{item:t,handleChangeField:c,field:"tax"})]})}),e("td",{children:e("input",{name:"total",type:"number",className:"form-input min-w-[200px]  form-input disabled:pointer-events-none bg-[#eee] dark:bg-[#1b2e4b]  cursor-text",defaultValue:t.total,disabled:!0,onChange:l=>c(l.target.name,l.target.value,t.id)})}),e("td",{children:e("button",{type:"button",onClick:()=>v(t),children:r("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})})]},t.id)})})]})}),r("div",{className:"flex justify-between sm:flex-row flex-col mt-6 px-4",children:[e("div",{className:"sm:mb-0 mb-6",children:e("button",{type:"button",className:"btn btn-primary",onClick:()=>x(),children:"Add Item"})}),r("div",{className:"sm:w-2/5",children:[r("div",{className:"flex items-center justify-between",children:[e("div",{children:"Subtotal(€)"}),e("input",{id:"subtotal",name:"subtotal",type:"text",value:i.subtotal,className:"w-64 form-input disabled:pointer-events-none disabled:bg-[#eee] dark:disabled:bg-[#1b2e4b] disabled:cursor-not-allowed",disabled:!0})]}),r("div",{className:"flex items-center justify-between mt-4",children:[e("div",{children:"Discount(€)"}),r("div",{className:"flex",children:[e("input",{id:"discount",name:"discount",type:"text",value:i.discount,disabled:!0,className:"w-56 form-input disabled:pointer-events-none bg-[#eee] dark:bg-[#1b2e4b] cursor-text"}),e(T,{item:i,handleChangeField:b,field:"discount"})]})]}),r("div",{className:"flex items-center justify-between mt-4",children:[e("div",{children:"Tax(€)"}),r("div",{className:"flex",children:[e("input",{id:"tax",name:"tax",type:"text",value:i.tax,disabled:!0,className:"w-56 form-input disabled:pointer-events-none bg-[#eee] dark:bg-[#1b2e4b]  cursor-text"}),e(T,{item:i,handleChangeField:b,field:"tax"})]})]}),r("div",{className:"flex items-center justify-between mt-4",children:[e("div",{children:"Adjustment(€)"}),e("input",{id:"adjustment",name:"adjustment",type:"text",value:i.adjustment,onChange:t=>b(t.target.name,t.target.value),className:"w-64 form-input "})]}),r("div",{className:"flex items-center justify-between mt-4 font-semibold",children:[e("div",{className:"flex-1",children:"Grand Total(€)"}),e("input",{id:"approved_by",name:"approved_by_id",type:"text",value:i.grandTotal,className:"w-64 form-input disabled:pointer-events-none disabled:bg-[#eee] dark:disabled:bg-[#1b2e4b] cursor-not-allowed",disabled:!0})]})]})]})]})]},"Quote Items")})})})},ae=()=>{const m=k(),a=F(i=>i.invoiceForm),o=(i,n)=>{m(y({[i]:n}))};return e(w,{children:e("div",{className:"flex justify-between lg:flex-row flex-col",children:e("div",{className:"lg:w-1/2 w-full ltr:lg:mr-6 rtl:lg:ml-6 mb-6",children:r("div",{className:"",children:[e("div",{className:"text-lg",children:"Terms and Conditions :"}),r("div",{className:"mt-4 flex items-center",children:[e("label",{className:"ltr:mr-2 rtl:ml-2 w-1/3 mb-0",children:"Terms and Conditions"}),e("textarea",{id:"terms_and_conditions",rows:3,name:"terms_conditions",className:"form-textarea flex-1",onChange:i=>o(i.target.name,i.target.value),value:a.terms_conditions,placeholder:""})]},"terms_and_conditions")]},"Terms and Conditions")})})})},te=()=>{const m=k(),a=F(i=>i.invoiceForm),o=(i,n)=>{m(y({[i]:n}))};return e(w,{children:e("div",{className:"flex justify-between lg:flex-row flex-col",children:e("div",{className:"lg:w-1/2 w-full ltr:lg:mr-6 rtl:lg:ml-6 mb-6",children:r("div",{className:"",children:[e("div",{className:"text-lg",children:"Description Information :"}),r("div",{className:"mt-4 flex items-center",children:[e("label",{className:"ltr:mr-2 rtl:ml-2 w-1/3 mb-0",children:"Description"}),e("textarea",{id:"description",rows:3,name:"description",className:"form-textarea flex-1",onChange:i=>o(i.target.name,i.target.value),value:a.description,placeholder:""})]},"description")]},"Terms and Conditions")})})})},ne=()=>r("div",{className:"mt-8 px-4",children:[e(K,{},"invoiceInformation"),e("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),e(X,{}),e("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),e(ee,{}),e("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),e(ae,{}),e("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),e(te,{})]}),be=()=>{const m=F(g=>g.invoiceForm),[a,o]=f.useState(!0),n=$().id,d=new M,p=k();f.useEffect(()=>{p(z("Invoice Edit"))});const c=async()=>{const g=await d.fetchSingleInvoice(n);if(g.status!=200)return;const x=g.data.data.invoice;p(y(x))};return f.useEffect(()=>{c().then(()=>{o(!1)})},[n]),f.useEffect(()=>{p(y({api:"updateSingleInvoice",redirectTo:"/invoice/edit/:id",action:"edit"}))},[]),a?e(J,{}):r("div",{className:"px-4",children:[e(W,{formState:m,resetForm:L}),e("div",{className:"flex xl:flex-row flex-col gap-2.5",children:e("div",{className:"panel px-0 flex-1 py-6 ltr:xl:mr-6 rtl:xl:ml-6 overflow-hidden",children:e(ne,{})})})]})};export{be as default};
