import{u as F,a as D,d as M,j as e,l as P,m as U,b as d,f as B,F as w,b4 as x,r as o,x as Q,w as $,n as I,a0 as G,z as W,y as z,aO as X,Y as H,X as J,aI as K,V as Z,B as ee,a1 as ae,E as le,b5 as te,h as Y,c as se,s as de,b6 as R,e as j}from"./main-3000a6dc.js";import{G as ne,A as re}from"./GenerateFields-7282bc65.js";import{S as N}from"./react-select.esm-2a6a39a3.js";import{F as V}from"./index-0aeaf758.js";import{T as E,o as q}from"./SelectOptions-b7204016.js";import{A as oe}from"./AttachmentSection-628d53a2.js";/* empty css                  */import"./index-29603cbb.js";const ie=()=>{var m,p,h,i,f;const u=F();new D;const a=M(s=>s.taskForm),r=(s,c)=>{u(x({[s]:c}))},b={"Task Information":{"Task Owner":e(P,{defaultOptions:!0,isMulti:!1,id:"owner_id",placeholder:"Type at least 2 characters to search...",name:"owner_id",loadOptions:U,onChange:({value:s})=>{r("owner_id",s)},className:"flex-1",defaultValue:{value:(m=a.owner)==null?void 0:m.id,label:d("div",{className:"flex items-center",children:[a.owner?e("img",{src:B(a.owner.avatar_data),alt:"avatar",className:"w-8 h-8 mr-2 rounded-full"}):null,d("div",{children:[e("div",{className:"text-sm font-bold",children:((p=a.owner)==null?void 0:p.first_name)+" "+((h=a.owner)==null?void 0:h.last_name)}),e("div",{className:"text-xs text-gray-500",children:(i=a.owner)==null?void 0:i.email})]})]},(f=a.owner)==null?void 0:f.id)}}),Subject:e("input",{id:"subject",name:"subject",className:"form-input flex-1 ",onChange:s=>r(s.target.name,s.target.value),required:!0,defaultValue:a.subject}),"Due Date":e(V,{name:"due_date",className:"form-input flex-1",defaultValue:a.due_date,placeholder:"YYYY-MM-DD",options:{dateFormat:"Y-m-d",defaultDate:a.due_date?new Date(a.due_date):null},onChange:(s,c)=>r("due_date",c)}),Status:e(N,{options:E,name:"status",id:"status",onChange:({value:s})=>{r("status",s)},className:"flex-1",defaultValue:E.find(s=>s.value==a.status)}),Priority:e(N,{options:q,name:"priority",id:"priority",onChange:({value:s})=>{r("priority",s)},defaultValue:q.find(s=>s.value==a.priority),className:"flex-1"})},"Description Information":{Description:e("textarea",{id:"description",rows:6,name:"description",className:"form-textarea flex-1",placeholder:"",defaultValue:a.description,onChange:s=>r(s.target.name,s.target.value)})}};return e(w,{children:e("div",{className:"flex justify-between lg:flex-row flex-col",children:e(ne,{fields:b})})})},ce=()=>{const u=F();new D;const a=M(l=>l.taskForm),[r,b]=o.useState(a.reminder),[m,p]=o.useState(a.reminder_on_date),[h,i]=o.useState(a.reminder_on_time),[f,s]=o.useState(a.days_before_due),[c,C]=o.useState(a.repeat_options),A={Monday:!1,Tuesday:!1,Wednesday:!1,Thursday:!1,Friday:!1,Saturday:!1,Sunday:!1},[v,_]=o.useState(A);o.useEffect(()=>{typeof a.selected_days=="object"&&_(l=>({...l,...a.selected_days}))},[a.selected_days]);const g=[{value:"email",label:"Email"},{value:"popup",label:"PopUp"},{value:"both",label:"Both"}],S=[{value:"none",label:"None"},{value:"daily",label:"Daily"},{value:"weekly",label:"Weekly"},a.due_date?{value:"specific",label:"Specific days before due date"}:null].filter(Boolean),t=(l,n)=>{l==="reminder"&&b(n),u(x({[l]:n}))},y=l=>{const n={...v,[l]:!v[l]};_(n),u(x({selected_days:n}))},T=()=>{_(l=>{const n={};for(const O in l)n[O]=!0;return u(x({selected_days:n})),n})},L=()=>{_(l=>{const n={};for(const O in l)n[O]=!1;return u(x({selected_days:n})),n})},k=a.due_date?Math.floor((new Date(a.due_date)-new Date)/(1e3*60*60*24)):0;return d("div",{className:"p-6 border rounded-md shadow-sm bg-white",children:[e("h2",{className:"text-xl font-semibold mb-4",children:"Reminder Settings"}),d("div",{className:"flex items-center space-x-4 mb-6",children:[e("label",{className:"text-lg",children:"Enable Reminder:"}),e("input",{id:"reminder",type:"checkbox",name:"reminder",className:"form-checkbox h-5 w-5 text-blue-600",onChange:l=>t(l.target.name,l.target.checked),defaultChecked:a.reminder})]}),r&&d("div",{children:[d("div",{className:"flex items-center space-x-4 my-2",children:[e("label",{children:"Next Reminder At:"})," ",e("span",{children:a.next_reminder_at})]}),d("div",{className:"flex items-center space-x-4 my-4",children:[e("label",{children:"On:"}),e(V,{className:"p-2 border rounded-md form-input flex-1","data-enable-time":!1,placeholder:"YYYY-MM-DD",value:m,onChange:(l,n)=>t("reminder_on_date",n),options:{dateFormat:"Y-m-d "}}),e("label",{children:"At:"}),e(V,{className:"p-2 border rounded-md form-input flex-1","data-enable-time":!0,"data-no-calendar":!0,value:h,onChange:l=>{i(l[0]),t("reminder_on_time",l[0])}}),e("label",{children:"Notify Type:"}),e(N,{id:"reminder_type",name:"reminder_type",onChange:({value:l})=>{t("reminder_type",l)},className:"flex-1",options:g,defaultValue:g.find(l=>l.value===a.reminder_type)})]}),d("div",{className:"flex items-center space-x-4 mb-4",children:[e("label",{className:"w-24",children:"Repeat:"}),e(N,{value:S.find(l=>l.value===c),options:S,className:"flex-1",name:"repeat_options",onChange:({value:l})=>{t("repeat_options",l),C(l)}})]}),c==="specific"&&a.due_date&&e(w,{children:d("div",{className:"flex items-center space-x-4 mb-4",children:[e("label",{className:"w-24",children:"Days before due:"}),e("input",{type:"number",min:"1",max:k,className:"p-2 border rounded-md form-input flex-1",value:f,onChange:l=>{const n=l.target.value;n>=1&&n<=k&&(s(n),t("days_before_due",n))}}),a.due_date&&d("button",{type:"button",className:"text-blue-500",onClick:()=>{s(k.toString()),t("days_before_due",k.toString())},children:["Max: ",k]})]})}),c==="weekly"&&d("div",{className:"mb-4",children:[e("label",{className:"block mb-2 w-24",children:"Select Days:"}),d("div",{className:"flex space-x-4",children:[d("div",{children:[e("button",{type:"button",onClick:T,className:"bg-blue-500 text-white px-3 py-1 rounded-md mr-2",children:"Check All"}),e("button",{type:"button",onClick:L,className:"bg-red-500 text-white px-3 py-1 rounded-md",children:"Uncheck All"})]}),Object.keys(v).map(l=>d("div",{className:"flex items-center space-x-2",children:[e("input",{type:"checkbox",id:l,checked:v[l],onChange:()=>y(l),className:"form-checkbox h-5 w-5 text-blue-600"}),e("label",{htmlFor:l,children:l})]},l))]})]})]})]})},ue=()=>{var g,S;const u=F();new D;const a=M(t=>t.taskForm),r=(t,y)=>{u(x({[t]:y}))},b=[{value:"App\\Models\\Lead",label:"Lead"},{value:"App\\Models\\Contact",label:"Contact"}],m=[{value:"App\\Models\\Account",label:"Account",api:I,labelFelid:"account_name"},{value:"App\\Models\\Vendor",label:"Vendor",api:G,labelFelid:"vendor_name"},{value:"App\\Models\\Quote",label:"Quote",api:W,labelFelid:"subject"},{value:"App\\Models\\Rfq",label:"Rfq",api:z,labelFelid:"rfq_name"},{value:"App\\Models\\Excess",label:"Excess",api:X,labelFelid:"excess_name"},{value:"App\\Models\\Availability",label:"Availability",api:H,labelFelid:"availability_name"},{value:"App\\Models\\Product",label:"Product",api:J,labelFelid:"product_name"},{value:"App\\Models\\Manufacturer",label:"Manufacturer",api:K,labelFelid:"name"},{value:"App\\Models\\Deal",label:"Deals",api:Z,labelFelid:"deal_name"},{value:"App\\Models\\SalesOrder",label:"Sales Order",api:ee,labelFelid:"subject"},{value:"App\\Models\\PurchaseOrder",label:"Purchase Order",api:ae,labelFelid:"subject"},{value:"App\\Models\\Invoice",label:"Invoice",api:le,labelFelid:"subject"},{value:"App\\Models\\VendorRfq",label:"Vendor Rfq",api:te,labelFelid:"vendor_rfq_name"}],[p,h]=o.useState(a.userable_type),[i,f]=o.useState(a.moduleable_type),[s,c]=o.useState({value:a.userable?a.userable.id:null,label:e("div",{className:"flex items-center",children:a.userable?d(w,{children:[e("img",{src:a.userable.image??"/assets/images/user-profile.jpeg",alt:"avatar",className:"w-8 h-8 mr-2 rounded-full"}),d("div",{children:[e("div",{className:"text-sm font-bold",children:`${a.userable.first_name} ${a.userable.last_name}`}),e("div",{className:"text-xs text-gray-500",children:a.userable.email})]})]}):e("div",{className:"text-sm font-bold"})},a.userable?a.userable.id:"default-key")}),C=((g=m.find(t=>t.value===a.moduleable_type))==null?void 0:g.labelFelid)||null,[A,v]=o.useState({value:a.moduleable?a.moduleable.id:null,label:e("div",{className:"flex items-center",children:e("div",{children:e("div",{className:"text-sm font-bold",children:a.moduleable?a.moduleable[C]:null})})},(S=a.moduleable)==null?void 0:S.id)}),_=t=>(m.find(T=>T.value===i)??{value:null,label:null,api:I}).api.call(null,t);return e(w,{children:d("div",{className:"p-6 border rounded-md",children:[d("div",{className:"flex items-center space-x-4 mb-5",children:[e("label",{className:"font-semibold",children:"Lead | Contact:"}),e(N,{id:"userable_type",name:"userable_type",defaultValue:b.find(t=>t.value==a.userable_type),onChange:({value:t})=>{h(t),r("userable_type",t),c(null)},className:"flex-1",options:b}),e(P,{defaultOptions:!0,isMulti:!1,id:"userable_id",placeholder:"Type at least 2 characters to search...",name:"userable_id",value:s,menuPortalTarget:document.body,menuPlacement:"top",loadOptions:p==="App\\Models\\Lead"?Q:$,onChange:({value:t,label:y})=>{c({value:t,label:y}),r("userable_id",t)},className:"flex-1",required:!0},p)]}),d("div",{className:"flex items-center space-x-4",children:[e("label",{className:"font-semibold",children:"Select Module :"}),e(N,{id:"moduleable_type",name:"moduleable_type",menuPortalTarget:document.body,menuPlacement:"top",defaultValue:m.find(t=>t.value==a.moduleable_type),onChange:({value:t})=>{f(t),r("moduleable_type",t),v(null)},className:"flex-1",options:m}),e(P,{defaultOptions:!0,isMulti:!1,id:"moduleable_id",menuPortalTarget:document.body,menuPlacement:"top",placeholder:"Type at least 2 characters to search...",name:"moduleable_id",value:A,loadOptions:t=>_(t),onChange:({value:t,label:y})=>{v({value:t,label:y}),r("moduleable_id",t)},className:"flex-1",required:!0},i)]})]})})},me=()=>{const a=Y().id;return d("div",{className:"mt-8 px-4",children:[e(ie,{},"leadInfo"),e("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),e(ce,{},"Reminder"),e("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),e(ue,{},"type"),e("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),e(oe,{modelId:a,modelName:"task"})]})},Ne=()=>{const{hasPermission:u}=se(),a=M(s=>s.taskForm),[r,b]=o.useState(!0),p=Y().id,h=new D,i=F();o.useEffect(()=>{i(de("Task Edit"))}),o.useEffect(()=>{i(R())},[]);const f=async()=>{const s=await h.fetchSingleTask(p);if(s.status!=200)return;const c=s.data.data.task;i(x(c))};return o.useEffect(()=>{f().then(()=>{b(!1)})},[p]),o.useEffect(()=>{i(x({api:"updateSingleTask",redirectTo:"/task/edit/:id",action:"edit"}))},[]),r?e(j,{}):!u("update-task")||r?e(j,{}):d("div",{className:"px-4",children:[e(re,{formState:a,resetForm:R}),e("div",{className:"flex xl:flex-row flex-col gap-2.5",children:e("div",{className:"panel px-0 flex-1 py-6 ltr:xl:mr-6 rtl:xl:ml-6 overflow-hidden",children:e(me,{})})})]})};export{Ne as default};
