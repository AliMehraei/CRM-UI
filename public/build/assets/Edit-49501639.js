import{u as T,d as O,a as q,b as e,j as r,F as P,am as _,r as o,c as I,h as Q,s as B,f as E,an as U}from"./main-1d204f78.js";import{A as j}from"./react-select-async.esm-19b258b2.js";import{G as Y,A as W}from"./GenerateFields-5a1cc3af.js";import{S as k}from"./react-select.esm-c3107f47.js";import{s as H,d as $,c as G,b as V,q as z,f as J,e as K,z as X,o as Z,m as ee,x as ae,l as le,i as te,r as se,j as re,H as de}from"./CommonFunctions-ef1be312.js";import{F as L}from"./index-d63a5304.js";/* empty css                  */import"./Select-aecb2a80.esm-27c7288e.js";import"./sweetalert2.all-da6653af.js";const ne=()=>{var y,i,v,c,u;const m=T();new O;const a=q(s=>s.taskForm),n=(s,g)=>{m(_({[s]:g}))},h=[{value:"-None-",label:"-None-"},{value:"Account or Contact exist already",label:"Account or Contact exist already"},{value:"Wrong Branch",label:"Wrong Branch"},{value:"Wrong Department",label:"Wrong Department"},{value:"Does Not Exist Anymore",label:"Does Not Exist Anymore"},{value:"Bankruptcy",label:"Bankruptcy"},{value:"Hoch",label:"Hoch"},{value:"Other",label:"Other"}],p=[{value:"-None-",label:"-None-"},{value:"Abgeschlossen",label:"Abgeschlossen"},{value:"0.0 Cold task / unqualified (CLU)",label:"0.0 Cold task / unqualified (CLU)"},{value:"1.0 Cold task qualified (CLQ)",label:"1.0 Cold task qualified (CLQ)"},{value:"2.0 First contact made (FCM)",label:"2.0 First contact made (FCM)"},{value:"3.0 warm task qualified (WLQ)",label:"3.0 warm task qualified (WLQ)"},{value:"4.0 Hot task (HLQ)",label:"4.0 Hot task (HLQ)"},{value:"Close Task / Lost Task",label:"Close Task / Lost Task"}],f={"Task Information":{"Task Owner":e(j,{isMulti:!1,id:"owner_id",placeholder:"Type at least 2 characters to search...",name:"owner_id",loadOptions:H,onChange:({value:s})=>{n("owner_id",s)},className:"flex-1",required:!0,defaultValue:{value:(y=a.owner)==null?void 0:y.id,label:r("div",{className:"flex items-center",children:[a.owner?e("img",{src:a.owner.image??"/assets/images/user-profile.jpeg",alt:"avatar",className:"w-8 h-8 mr-2 rounded-full"}):null,r("div",{children:[e("div",{className:"text-sm font-bold",children:((i=a.owner)==null?void 0:i.first_name)+" "+((v=a.owner)==null?void 0:v.last_name)}),e("div",{className:"text-xs text-gray-500",children:(c=a.owner)==null?void 0:c.email})]})]},(u=a.owner)==null?void 0:u.id)}}),Subject:e("input",{id:"subject",name:"subject",className:"form-input flex-1 ",onChange:s=>n(s.target.name,s.target.value),required:!0,defaultValue:a.subject}),"Due Date":e(L,{name:"due_date",className:"form-input flex-1",defaultValue:a.due_date,placeholder:"YYYY-MM-DD",options:{dateFormat:"Y-m-d",defaultDate:a.due_date?new Date(a.due_date):null},onChange:(s,g)=>n("due_date",g)}),Status:e(k,{options:p,name:"status",id:"status",onChange:({value:s})=>{n("status",s)},className:"flex-1",defaultValue:p.find(s=>s.value==a.status)}),Priority:e(k,{options:h,name:"priority",id:"priority",onChange:({value:s})=>{n("priority",s)},defaultValue:h.find(s=>s.value==a.priority),className:"flex-1"})},"Description Information":{Description:e("textarea",{id:"description",rows:6,name:"description",className:"form-textarea flex-1",placeholder:"",defaultValue:a.description,onChange:s=>n(s.target.name,s.target.value)})}};return e(P,{children:e("div",{className:"flex justify-between lg:flex-row flex-col",children:e(Y,{fields:f})})})},oe=()=>{const m=T();new O;const a=q(t=>t.taskForm),[n,h]=o.useState(a.reminder),[p,f]=o.useState(a.reminder_on_date),[y,i]=o.useState(a.reminder_on_time),[v,c]=o.useState(a.days_before_due),[u,s]=o.useState(a.repeat_options),g={Monday:!1,Tuesday:!1,Wednesday:!1,Thursday:!1,Friday:!1,Saturday:!1,Sunday:!1},[S,N]=o.useState(g);o.useEffect(()=>{if(a.selected_days)try{const t=JSON.parse(a.selected_days),l=Object.keys(t).filter(d=>t[d]);N(d=>({...d,...l.reduce((M,R)=>(M[R]=!0,M),{})}))}catch(t){console.error("Error parsing selected_days:",t)}},[a.selected_days]);const C=[{value:"email",label:"Email"},{value:"popup",label:"PopUp"},{value:"both",label:"Both"}],D=[{value:"none",label:"None"},{value:"daily",label:"Daily"},{value:"weekly",label:"Weekly"},a.due_date?{value:"specific",label:"Specific days before due date"}:null].filter(Boolean),b=(t,l)=>{t==="reminder"&&h(l),m(_({[t]:l}))},w=t=>{N(l=>{const d={...l,[t]:!l[t]};return m(_({selected_days:d})),d})},F=()=>{N(t=>{const l={};for(const d in t)l[d]=!0;return m(_({selected_days:l})),l})},A=()=>{N(t=>{const l={};for(const d in t)l[d]=!1;return m(_({selected_days:l})),l})},x=a.due_date?Math.floor((new Date(a.due_date)-new Date)/(1e3*60*60*24)):0;return r("div",{className:"p-6 border rounded-md shadow-sm bg-white",children:[e("h2",{className:"text-xl font-semibold mb-4",children:"Reminder Settings"}),r("div",{className:"flex items-center space-x-4 mb-6",children:[e("label",{className:"text-lg",children:"Enable Reminder:"}),e("input",{id:"reminder",type:"checkbox",name:"reminder",className:"form-checkbox h-5 w-5 text-blue-600",onChange:t=>b(t.target.name,t.target.checked),defaultChecked:a.reminder})]}),n&&r("div",{children:[r("div",{className:"flex items-center space-x-4 my-4",children:[e("label",{children:"On:"}),e(L,{className:"p-2 border rounded-md form-input flex-1","data-enable-time":!1,placeholder:"YYYY-MM-DD",value:p,onChange:(t,l)=>b("reminder_on_date",l),options:{dateFormat:"Y-m-d "}}),e("label",{children:"At:"}),e(L,{className:"p-2 border rounded-md form-input flex-1","data-enable-time":!0,"data-no-calendar":!0,value:y,onChange:t=>{i(t[0]),b("reminder_on_time",t[0])}})," //TODO:: fix this",e("label",{children:"Notify Type:"}),e(k,{id:"reminder_type",name:"reminder_type",onChange:({value:t})=>{b("reminder_type",t)},className:"flex-1",options:C,defaultValue:C.find(t=>t.value===a.reminder_type)})]}),r("div",{className:"flex items-center space-x-4 mb-4",children:[e("label",{className:"w-24",children:"Repeat:"}),e(k,{value:D.find(t=>t.value===u),options:D,className:"flex-1",name:"repeat_options",onChange:({value:t})=>{b("repeat_options",t),s(t)}})]}),u==="specific"&&a.due_date&&e(P,{children:r("div",{className:"flex items-center space-x-4 mb-4",children:[e("label",{className:"w-24",children:"Days before due:"}),e("input",{type:"number",min:"1",max:x,className:"p-2 border rounded-md form-input flex-1",value:v,onChange:t=>{const l=t.target.value;l>=1&&l<=x&&(c(l),b("days_before_due",l))}}),a.due_date&&r("button",{type:"button",className:"text-blue-500",onClick:()=>{c(x.toString()),b("days_before_due",x.toString())},children:["Max: ",x]})]})}),u==="weekly"&&r("div",{className:"mb-4",children:[e("label",{className:"block mb-2 w-24",children:"Select Days:"}),r("div",{className:"flex space-x-4",children:[r("div",{children:[e("button",{type:"button",onClick:F,className:"bg-blue-500 text-white px-3 py-1 rounded-md mr-2",children:"Check All"}),e("button",{type:"button",onClick:A,className:"bg-red-500 text-white px-3 py-1 rounded-md",children:"Uncheck All"})]}),Object.keys(S).map(t=>r("div",{className:"flex items-center space-x-2",children:[e("input",{type:"checkbox",id:t,checked:S[t],onChange:()=>w(t),className:"form-checkbox h-5 w-5 text-blue-600"}),e("label",{htmlFor:t,children:t})]},t))]})]})]})]})},ce=()=>{var C,D,b,w,F,A,x,t;const m=T();new O;const a=q(l=>l.taskForm),n=(l,d)=>{m(_({[l]:d}))},h=[{value:"App\\Models\\Lead",label:"Lead"},{value:"App\\Models\\Contact",label:"Contact"}],p=[{value:"App\\Models\\Account",label:"Account",api:V,labelFelid:"account_name"},{value:"App\\Models\\Vendor",label:"Vendor",api:z,labelFelid:"vendor_name"},{value:"App\\Models\\Quote",label:"Quote",api:J,labelFelid:"subject"},{value:"App\\Models\\Rfq",label:"Rfq",api:K,labelFelid:"rfq_name"},{value:"App\\Models\\Excess",label:"Excess",api:X,labelFelid:"excess_name"},{value:"App\\Models\\Availability",label:"Availability",api:Z,labelFelid:"availability_name"},{value:"App\\Models\\Product",label:"Product",api:ee,labelFelid:"product_name"},{value:"App\\Models\\Manufacturer",label:"Manufacturer",api:ae,labelFelid:"name"},{value:"App\\Models\\Deal",label:"Deals",api:le,labelFelid:"deal_name"},{value:"App\\Models\\SalesOrder",label:"Sales Order",api:te,labelFelid:"subject"},{value:"App\\Models\\PurchaseOrder",label:"Purchase Order",api:se,labelFelid:"subject"},{value:"App\\Models\\Invoice",label:"Invoice",api:re,labelFelid:"subject"},{value:"App\\Models\\VendorRfq",label:"Vendor Rfq",api:de,labelFelid:"vendor_rfq_name"}],[f,y]=o.useState(a.userable_type),[i,v]=o.useState(a.moduleable_type),[c,u]=o.useState({value:(C=a.userable)==null?void 0:C.id,label:r("div",{className:"flex items-center",children:[a.userable?e("img",{src:a.userable.image??"/assets/images/user-profile.jpeg",alt:"avatar",className:"w-8 h-8 mr-2 rounded-full"}):null,r("div",{children:[e("div",{className:"text-sm font-bold",children:`${(D=a.userable)==null?void 0:D.first_name} ${(b=a.userable)==null?void 0:b.last_name}`}),e("div",{className:"text-xs text-gray-500",children:(w=a.userable)==null?void 0:w.email})]})]},(F=a.userable)==null?void 0:F.id)}),s=(A=p.find(l=>l.value===a.moduleable_type))==null?void 0:A.labelFelid,[g,S]=o.useState({value:(x=a.moduleable)==null?void 0:x.id,label:e("div",{className:"flex items-center",children:e("div",{children:e("div",{className:"text-sm font-bold",children:a.moduleable[s]})})},(t=a.moduleable)==null?void 0:t.id)}),N=l=>(p.find(M=>M.value===i)??{value:"App\\Models\\Account",label:"Account",api:V}).api.call(null,l);return e(P,{children:r("div",{className:"p-6 border rounded-md",children:[r("div",{className:"flex items-center space-x-4 mb-5",children:[e("label",{className:"font-semibold",children:"Lead | Contact:"}),e(k,{id:"userable_type",name:"userable_type",defaultValue:h.find(l=>l.value==a.userable_type),onChange:({value:l})=>{y(l),n("userable_type",l),u(null)},className:"flex-1",options:h}),e(j,{isMulti:!1,id:"userable_id",placeholder:"Type at least 2 characters to search...",name:"userable_id",value:c,menuPortalTarget:document.body,menuPlacement:"top",loadOptions:f==="App\\Models\\Lead"?$:G,onChange:({value:l,label:d})=>{u({value:l,label:d}),n("userable_id",l)},className:"flex-1",required:!0},f)]}),r("div",{className:"flex items-center space-x-4",children:[e("label",{className:"font-semibold",children:"Select Module :"}),e(k,{id:"moduleable_type",name:"moduleable_type",menuPortalTarget:document.body,menuPlacement:"top",defaultValue:p.find(l=>l.value==a.moduleable_type),onChange:({value:l})=>{v(l),n("moduleable_type",l),S(null)},className:"flex-1",options:p}),e(j,{isMulti:!1,id:"moduleable_id",menuPortalTarget:document.body,menuPlacement:"top",placeholder:"Type at least 2 characters to search...",name:"moduleable_id",value:g,loadOptions:l=>N(l),onChange:({value:l,label:d})=>{S({value:l,label:d}),n("moduleable_id",l)},className:"flex-1",required:!0},i)]})]})})},ie=()=>r("div",{className:"mt-8 px-4",children:[e(ne,{},"leadInfo"),e("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),e(oe,{},"Reminder"),e("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),e(ce,{},"type"),e("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"})]}),_e=()=>{const{hasPermission:m}=I(),a=q(c=>c.taskForm),[n,h]=o.useState(!0),f=Q().id,y=new O,i=T();o.useEffect(()=>{i(B("Task Edit"))});const v=async()=>{const c=await y.fetchSingleTask(f);if(c.status!=200)return;const u=c.data.data.task;i(_(u))};return o.useEffect(()=>{v().then(()=>{h(!1)})},[f]),o.useEffect(()=>{i(_({api:"updateSingleTask",redirectTo:"/task/edit/:id",action:"edit"}))},[]),n?e(E,{}):!m("update-task")||n?e(E,{}):r("div",{className:"px-4",children:[e(W,{formState:a,resetForm:U}),e("div",{className:"flex xl:flex-row flex-col gap-2.5",children:e("div",{className:"panel px-0 flex-1 py-6 ltr:xl:mr-6 rtl:xl:ml-6 overflow-hidden",children:e(ie,{})})})]})};export{_e as default};
