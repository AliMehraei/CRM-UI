import{r as a,j as e,b as o,a as Y,u as be,F as k,bb as Te,l as Ce,m as ve,L as ye,c as De,s as xe}from"./main-3000a6dc.js";import{L as R}from"./LoadingSpinner-213baec3.js";import{L}from"./LastPeriodCompareWidget-34b954dd.js";import{_ as Se}from"./react-apexcharts.min-a5f56c47.js";import{F as Ne}from"./index-0aeaf758.js";/* empty css                  */import{S as we}from"./react-select.esm-2a6a39a3.js";const ke=({dateStartFilter:r,dateEndFilter:g,statusFilter:t,personFilter:n})=>{const[C,D]=a.useState(!0),v=new Y,[h,u]=a.useState(!1),i={series:[{name:"PRODUCT A",data:[44,55,41,67,22,43]},{name:"PRODUCT B",data:[13,23,20,8,13,27]},{name:"PRODUCT C",data:[11,17,15,15,21,14]},{name:"PRODUCT D",data:[21,7,25,13,22,8]}],options:{chart:{type:"bar",height:350,stacked:!0,toolbar:{show:!1},zoom:{enabled:!0},dataLabels:{enabled:!1}},dataLabels:{enabled:!1},responsive:[{breakpoint:480,options:{legend:{position:"bottom",offsetX:-10,offsetY:0}}}],plotOptions:{bar:{horizontal:!1,borderRadius:10,dataLabels:{enabled:!1,total:{enabled:!1}}},dataLabels:{total:{enabled:!1}}},xaxis:{categories:["01/01/2011 GMT","01/02/2011 GMT","01/03/2011 GMT","01/04/2011 GMT","01/05/2011 GMT","01/06/2011 GMT"]},legend:{position:"right",offsetY:40},fill:{opacity:1},yaxis:{opposite:!1,labels:{offsetX:0,formatter:function(s){return new Intl.NumberFormat("en-US",{style:"currency",currency:"EUR",minimumFractionDigits:2}).format(s)}}}}},[m,c]=a.useState(i),S=async()=>{try{const s=await v.reportSalesChartMTD({status:t,date_start:r??"",date_end:g??"",sales_person:n});if(s.status===200){const p=s.data.data,d=i;d.series=p.series,d.options.xaxis.categories=p.options,c(d),D(!1)}else console.error("Failed to fetch MTD Billing Inc.Backlog:",s)}catch(s){console.error("An error occurred while fetching MTD Billing Inc.Backlog: ",s)}};return a.useEffect(()=>{S(),(t.length>0||n.length>0||r!="")&&u(!0)},[t,n,r]),e("div",{className:"pt-5 flex-1",children:e("div",{className:"grid  gap-6 mb-6",children:e("div",{className:"panel h-full xl:col-span-2",children:o("div",{className:"relative",children:[e("h5",{className:"font-semibold text-lg",children:h===!1?"MTD Sales":"Filtered Sales Performance Analysis"}),e("div",{className:"bg-white dark:bg-black rounded-lg",children:C?e(R,{}):e(Se,{series:m.series,options:m.options,className:"rounded-lg bg-white dark:bg-black",type:"bar",height:300})})]})})})})},Pe=({setDateStartFilter:r,setDateEndFilter:g,setStatusFilter:t,setPersonFilter:n,dateStartFilter:C,dateEndFilter:D,statusFilter:v,personFilter:h})=>{be();const[u,i]=a.useState(""),[m,c]=a.useState(""),[S,s]=a.useState(""),[p,d]=a.useState([]),[x,N]=a.useState([]),[f,T]=a.useState([]),[E,P]=a.useState([]),F=l=>{N(l);const b=l.map(y=>y.value);d(b)},A=l=>{P(l);const b=l.map(y=>y.value);T(b)},M=()=>{t(p),n(f),r(m),g(S)},_=l=>{if(Array.isArray(l)&&l.length===2){const b=new Date(l[0].getTime()-l[0].getTimezoneOffset()*6e4).toISOString().split("T")[0],y=new Date(l[1].getTime()-l[1].getTimezoneOffset()*6e4).toISOString().split("T")[0],O=`${b} to ${y}`;i(O)}};return a.useEffect(()=>{const[l,b]=u.split(" to ");c(l),s(b)},[u]),e(k,{children:e("div",{className:"panel  border-white-light dark:border-[#1b2e4b]",children:o("div",{className:"grid sm:grid-cols-12 md:grid-cols-4 gap-3 mb-10",children:[o("div",{className:"inline-block gap-3",children:[e("label",{className:"sm:col-span-4 mt-2 block text-[16px] font-semibold text-gray-800",children:"Select Status :"}),e(we,{isMulti:!0,options:Te,name:"status",id:"status",value:x,onChange:F,className:"sm:col-span-8 lg:col-span-2",placeholder:"Select Status"})]}),o("div",{className:"inline-block gap-3",children:[e("label",{className:"sm:col-span-4 mt-2 block text-[16px] font-semibold text-gray-800",children:"Select Sales Person :"}),e(Ce,{defaultOptions:!0,isMulti:!0,id:"owner_id",placeholder:"Select Sales Person",loadOptions:ve,onChange:A,className:"sm:col-span-8 lg:col-span-2"})]}),o("div",{className:"inline-block gap-3",children:[e("label",{className:"sm:col-span-4 mt-2 block text-[16px] font-semibold text-gray-800",children:"Select Date :"}),o("div",{className:"inline-flex",children:[e(Ne,{options:{mode:"range",dateFormat:"Y-m-d",position:"auto left"},value:u,className:"sm:col-span-8 form-input w-56",onChange:l=>_(l)}),e("a",{className:"input-button ml-2 cursor-pointer",title:"Clear",onClick:()=>{i(""),c(""),s("")},children:o("svg",{width:"35",height:"35",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e("path",{opacity:"0.5",d:"M2 12C2 7.28595 2 4.92893 3.46447 3.46447C4.92893 2 7.28595 2 12 2C16.714 2 19.0711 2 20.5355 3.46447C22 4.92893 22 7.28595 22 12C22 16.714 22 19.0711 20.5355 20.5355C19.0711 22 16.714 22 12 22C7.28595 22 4.92893 22 3.46447 20.5355C2 19.0711 2 16.714 2 12Z",stroke:"#1C274C","stroke-width":"1.5"}),e("path",{d:"M14.5 9.50002L9.5 14.5M9.49998 9.5L14.5 14.5",stroke:"#1C274C","stroke-width":"1.5","stroke-linecap":"round"})]})})]})]}),o("div",{className:"inline-block lg:justify-end  lg:mt-9",children:[e("button",{type:"button",onClick:M,className:"sm:col-span-12 lg:col-span-2 float-right block items-center  px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:" Filter"}),e(ye,{type:"button",className:"sm:col-span-12 lg:col-span-2 float-right block items-center  mx-3 px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600",to:"/admin-analytics/sales-order",reloadDocument:!0,children:"Reset"})]})]})})})},Fe=({dateStartFilter:r,dateEndFilter:g,statusFilter:t,personFilter:n})=>{const[C,D]=a.useState(!0),v=new Y,h={series:[{name:"PRODUCT A",data:[44,55,41,67,22,43]},{name:"PRODUCT B",data:[13,23,20,8,13,27]},{name:"PRODUCT C",data:[11,17,15,15,21,14]},{name:"PRODUCT D",data:[21,7,25,13,22,8]}],options:{chart:{type:"bar",height:350,stacked:!0,toolbar:{show:!1},zoom:{enabled:!0},dataLabels:{enabled:!1}},dataLabels:{enabled:!1},responsive:[{breakpoint:480,options:{legend:{position:"bottom",offsetX:-10,offsetY:0}}}],plotOptions:{bar:{horizontal:!1,borderRadius:10,dataLabels:{enabled:!1,total:{enabled:!1}}},dataLabels:{total:{enabled:!1}}},xaxis:{categories:["01/01/2011 GMT","01/02/2011 GMT","01/03/2011 GMT","01/04/2011 GMT","01/05/2011 GMT","01/06/2011 GMT"]},legend:{position:"right",offsetY:40},fill:{opacity:1},yaxis:{opposite:!1,labels:{offsetX:0,formatter:function(s){return new Intl.NumberFormat("en-US",{style:"currency",currency:"EUR",minimumFractionDigits:2}).format(s)}}}}},[u,i]=a.useState(!1),[m,c]=a.useState(h),S=async()=>{try{const s=await v.reportSalesChartYTD({status:t,date_start:r??"",date_end:g??"",sales_person:n});if(s.status===200){const p=s.data.data,d=h;d.series=p.series,d.options.xaxis.categories=p.options,c(d),D(!1)}else console.error("Failed to fetch Booking Sales YTD:",s)}catch(s){console.error("An error occurred while fetching Booking Sales YTD: ",s)}};return a.useEffect(()=>{S(),(t.length>0||n.length>0||r!="")&&i(!0)},[t,n,r]),e("div",{className:"pt-5 flex-1",children:e("div",{className:"grid  gap-6 mb-6",children:e("div",{className:"panel h-full xl:col-span-2",children:o("div",{className:"relative",children:[e("h5",{className:"font-semibold text-lg",children:u===!1?"YTD Sales":"Filtered Sales Performance Analysis"}),e("div",{className:"bg-white dark:bg-black rounded-lg",children:C?e(R,{}):e(Se,{series:m.series,options:m.options,className:"rounded-lg bg-white dark:bg-black",type:"bar",height:300})})]})})})})},Ae=({dateStartFilter:r,dateEndFilter:g,statusFilter:t,personFilter:n})=>{const C=new Y,[D,v]=a.useState(!0),[h,u]=a.useState(0),[i,m]=a.useState(0),[c,S]=a.useState(0),[s,p]=a.useState(0),[d,x]=a.useState(!1),N=async()=>{try{const f=await C.reportSalesDetails({status:t,date_start:r??"",date_end:g??"",sales_person:n});if(f.status===200){const T=f.data.data;S(T.average),p(T.count),m(T.gpTotal),u(T.total),v(!1)}else console.error("Failed to fetch Sales Details:",f)}catch(f){console.error("An error Sales Details: ",f)}};return a.useEffect(()=>{N(),(t.length>0||n.length>0||r!="")&&x(!0)},[t,n,r]),e(k,{children:o("div",{className:"panel  border-white-light dark:border-[#1b2e4b]",children:[e("h2",{className:"text-xl font-bold mb-4",children:d===!1?"Year in Review: 12-Month Filtered Sales Analysis":"Filtered Sales Performance Analysis"}),e("div",{className:"grid sm:grid-cols-1 lg:grid-cols-1 gap-6 mb-6",children:D?e(R,{}):o("div",{className:"flex justify-between items-center p-4",children:[o("div",{className:"inline-flex gap-3",children:[e("label",{children:"Sales Total: "}),e("span",{children:h})]}),o("div",{className:"inline-flex gap-3",children:[e("label",{children:"GP Total: "}),e("span",{children:i})]}),o("div",{className:"inline-flex gap-3",children:[e("label",{children:"Count: "}),e("span",{children:s})]}),o("div",{className:"inline-flex gap-3",children:[e("label",{children:"Average: "}),e("span",{children:c})]})]})})]})})},Ge=()=>{var x,N,f,T,E,P,F,A,M,_,l,b,y,O,G,U,B,z,I,j,$,X,V,W,Z,q,H,J,K,Q,ee,te,ae,se,le,oe,re,ne,ie,ce,de,he,ue,me,pe,ge,fe;const r=be(),{hasPermission:g}=De();a.useEffect(()=>{r(xe("Sales Performance Analytics"))},[r]);const[t,n]=a.useState(null),C=new Y,[D,v]=a.useState(!0);a.useState("2023-07-05 to 2023-07-10");const[h,u]=a.useState(""),[i,m]=a.useState(""),[c,S]=a.useState([]),[s,p]=a.useState([]),d=async()=>{try{const w=await C.dashboardData();w.status===200?n(w.data.data.sales_order):console.error("Failed to fetch dashboard data:",w)}catch(w){console.error("An error occurred while fetching dashboard data:",w)}finally{v(!1)}};return a.useEffect(()=>{d()},[]),o("div",{className:"panel  border-white-light dark:border-[#1b2e4b]",children:[g("admin-sales-order-analytics")?e(k,{children:e("div",{className:"grid sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:t?o(k,{children:[e(L,{currentAmount:((N=(x=t.ytd)==null?void 0:x.all)==null?void 0:N.total)||0,lastPeriodAmount:((T=(f=t.last_year)==null?void 0:f.all)==null?void 0:T.total)||0,sectionTitle:"Sales Order YTD",firstColor:"blue-500",secondColor:"blue-400",currentTitle:"This Year",lastPeriodTitle:"Last Year",currentAverage:parseFloat(((P=(E=t.ytd)==null?void 0:E.all)==null?void 0:P.average)||"0"),currentCount:((A=(F=t.ytd)==null?void 0:F.all)==null?void 0:A.count)||0,lastPeriodAverage:parseFloat(((_=(M=t.last_year)==null?void 0:M.all)==null?void 0:_.average)||"0"),lastPeriodCount:((b=(l=t.last_year)==null?void 0:l.all)==null?void 0:b.count)||0}),e(L,{currentAmount:((O=(y=t.ytd)==null?void 0:y.closed)==null?void 0:O.total)||0,lastPeriodAmount:((U=(G=t.last_year)==null?void 0:G.closed)==null?void 0:U.total)||0,sectionTitle:"Sales Order (Closed) YTD",firstColor:"cyan-500",secondColor:"cyan-400",currentTitle:"This Year",lastPeriodTitle:"Last Year",currentAverage:parseFloat(((z=(B=t.ytd)==null?void 0:B.closed)==null?void 0:z.average)||"0"),currentCount:((j=(I=t.ytd)==null?void 0:I.closed)==null?void 0:j.count)||0,lastPeriodAverage:parseFloat(((X=($=t.last_year)==null?void 0:$.closed)==null?void 0:X.average)||"0"),lastPeriodCount:((W=(V=t.last_year)==null?void 0:V.closed)==null?void 0:W.count)||0}),e(L,{currentAmount:((q=(Z=t.mtd)==null?void 0:Z.all)==null?void 0:q.total)||0,lastPeriodAmount:((J=(H=t.last_month)==null?void 0:H.all)==null?void 0:J.total)||0,sectionTitle:"Sales Order MTD",firstColor:"fuchsia-500",secondColor:"fuchsia-400",currentTitle:"This Month",lastPeriodTitle:"Last Month",currentAverage:parseFloat(((Q=(K=t.mtd)==null?void 0:K.all)==null?void 0:Q.average)||"0"),currentCount:((te=(ee=t.mtd)==null?void 0:ee.all)==null?void 0:te.count)||0,lastPeriodAverage:parseFloat(((se=(ae=t.last_month)==null?void 0:ae.all)==null?void 0:se.average)||"0"),lastPeriodCount:((le=t.last_month.all)==null?void 0:le.count)||0}),e(L,{currentAmount:((re=(oe=t.mtd)==null?void 0:oe.closed)==null?void 0:re.total)||0,lastPeriodAmount:((ie=(ne=t.last_month)==null?void 0:ne.closed)==null?void 0:ie.total)||0,sectionTitle:"Sales Order (Closed) MTD",firstColor:"violet-500",secondColor:"violet-400",currentTitle:"This Month",lastPeriodTitle:"Last Month",currentAverage:parseFloat(((de=(ce=t.mtd)==null?void 0:ce.closed)==null?void 0:de.average)||"0"),currentCount:((ue=(he=t.mtd)==null?void 0:he.closed)==null?void 0:ue.count)||0,lastPeriodAverage:parseFloat(((pe=(me=t.last_month)==null?void 0:me.closed)==null?void 0:pe.average)||"0"),lastPeriodCount:((fe=(ge=t.last_month)==null?void 0:ge.closed)==null?void 0:fe.count)||0})]}):e(R,{})})}):null,g("admin-sales-order-analytics")?o(k,{children:[e(Pe,{setDateStartFilter:u,setDateEndFilter:m,setStatusFilter:S,setPersonFilter:p,dateStartFilter:h,dateEndFilter:i,statusFilter:c,personFilter:s}),e(ke,{dateStartFilter:h,dateEndFilter:i,statusFilter:c,personFilter:s}),e(Fe,{dateStartFilter:h,dateEndFilter:i,statusFilter:c,personFilter:s}),e(Ae,{dateStartFilter:h,dateEndFilter:i,statusFilter:c,personFilter:s})]}):null]})};export{Ge as default};
