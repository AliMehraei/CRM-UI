import{u as q,a as C,b as e,U as k,V as Y,aI as L,F,aH as b,m as I,j as d,f as M,v as H,l as B,k as P,Z as U,h as j,c as $,r as N,J as G,s as J,aJ as A,d as E,e as W,S as K,K as Z}from"./main-50485d15.js";/* empty css                  */import{A as m}from"./react-select-async.esm-53710751.js";import{G as S,A as z}from"./GenerateFields-6139070c.js";import{F as w}from"./index-f8187673.js";import{T as X}from"./tippy-react.esm-363549f5.js";import{S as y}from"./react-select.esm-57321b92.js";import{F as ee}from"./FileUploadComponent-8c59c0cd.js";import{A as ae}from"./AttachmentSection-62c82d50.js";import"./Select-aecb2a80.esm-2b02e9fd.js";import"./ClearButtonComponent-e25df4a8.js";const te=()=>{var n,o,g,f,p,h,_,r,c;const u=q(),a=C(s=>s.rfqFormSlice),l=(s,x)=>{u(b({[s]:x}))},i={"RFQ Line":{"Product Name":e(m,{defaultOptions:!0,isMulti:!1,id:"product_id",placeholder:"Type at least 2 characters to search...",loadOptions:k,onChange:({value:s})=>{l("product_id",s)},defaultValue:{value:(n=a.product)==null?void 0:n.id,label:e("div",{className:"flex items-center",children:e("div",{className:"text-sm font-bold",children:(o=a.product)==null?void 0:o.product_name})},(g=a.product)==null?void 0:g.id)},className:"flex-1",required:!0}),"Customer Part Id":e("input",{id:"customer_part_id",name:"customer_part_id",className:"form-input flex-1 ",defaultValue:a.customer_part_id,onChange:s=>l(s.target.name,s.target.value)}),Quantity:e("input",{id:"quantity",name:"quantity",className:"form-input flex-1 ",defaultValue:a.quantity,onChange:s=>l(s.target.name,s.target.value),required:!0}),"Target Price":e("input",{id:"target_price",name:"target_price",defaultValue:a.target_price,onChange:s=>l(s.target.name,s.target.value),className:"form-input flex-1 "})},"":{"Alternative Products":e(m,{defaultOptions:!0,id:"alternative_products",name:"alternative_products",placeholder:"Type at least 2 characters to search...",loadOptions:k,onChange:s=>{l("alternative_products",s.map(x=>x.value))},isMulti:!0,defaultValue:a.rfq_product_alternatives?a.rfq_product_alternatives.map(s=>({value:s.id,label:e("div",{className:"flex items-center",children:e("div",{children:e("div",{className:"text-sm font-bold",children:s.product_name})})},s.id)})):[],className:"flex-1"}),Availability:e(m,{defaultOptions:!0,isMulti:!1,id:"availability",name:"availability_id",placeholder:"Type at least 2 characters to search...",loadOptions:Y,onChange:({value:s})=>{l("availability_id",s)},defaultValue:{value:(f=a.contact)==null?void 0:f.id,label:e("div",{className:"flex items-center",children:e("div",{className:"text-sm font-bold",children:(p=a.availability)==null?void 0:p.availability_name})},(h=a.availability)==null?void 0:h.id)},className:"flex-1"}),Excess:e(m,{defaultOptions:!0,isMulti:!1,id:"excess_id",name:"excess_id",placeholder:"Type at least 2 characters to search...",loadOptions:L,onChange:({value:s})=>{l("excess_id",s)},defaultValue:{value:(_=a.excess)==null?void 0:_.id,label:e("div",{className:"flex items-center",children:e("div",{className:"text-sm font-bold",children:(r=a.excess)==null?void 0:r.excess_name})},(c=a.excess)==null?void 0:c.id)},className:"flex-1"}),"Special Instructions":e("textarea",{id:"special_instructions",name:"special_instructions",rows:3,defaultValue:a.special_instructions,onChange:s=>l(s.target.name,s.target.value),className:"form-textarea flex-1"}),comment:e("textarea",{id:"comment",rows:3,name:"comment",className:"form-textarea flex-1",defaultValue:a.comment,onChange:s=>l(s.target.name,s.target.value),placeholder:""})}};return e(F,{children:e("div",{className:"flex justify-between lg:flex-row flex-col",children:e(S,{fields:i})})})},le=()=>{const u=q(),a=C(n=>n.rfqFormSlice),l=(n,o)=>{u(b({[n]:o}))},i={Development:{"Processed for VRFQ round 1":e(X,{content:"Please do not change the value",className:"red",children:e("input",{id:"processed_for_vrfq_round_1",type:"checkbox",name:"processed_for_vrfq_round_1",className:"form-checkbox",onChange:n=>l(n.target.name,n.target.checked),checked:a.processed_for_vrfq_round_1=="true"})}),"Processed for VRFQ round 2":e("label",{className:"flex items-center cursor-pointer",children:e("input",{id:"processed_for_vrfq_round_2",type:"checkbox",name:"processed_for_vrfq_round_2",className:"form-checkbox",onChange:n=>l(n.target.name,n.target.checked),checked:a.processed_for_vrfq_round_2=="true"})}),"Open Status Time":e(w,{name:"open_status_timestamp","data-enable-time":!0,options:{enableTime:!0,dateFormat:"Y-m-d H:i",position:"auto left",defaultDate:a.open_status_date?new Date(a.open_status_date+" "+a.open_status_time):null},defaultValue:a.open_status_timestamp,onChange:(n,o)=>l("open_status_timestamp",o),className:"form-input flex-1"})}};return e(F,{children:e("div",{className:"flex justify-between lg:flex-row flex-col",children:e(S,{fields:i})})})},se=()=>{var p,h,_,r,c,s,x,V,R,O,D,T,Q;const u=q(),a=C(t=>t.rfqFormSlice),l=(t,v)=>{u(b({[t]:v}))},i=[{value:"none",label:"-None-"},{value:"email",label:"Email"},{value:"telephone",label:"Telephone"},{value:"web_portal",label:"Web portal"},{value:"history",label:"History"}],n=[{value:"none",label:"-None-"},{value:"cost_saving",label:"Cost Saving"},{value:"shortage",label:"Shortage"},{value:"eol",label:"EOL"},{value:"proactive",label:"Proactive"},{value:"calculation",label:"Calculation"}],o=[{value:"none",label:"-None-"},{value:"open",label:"Open"},{value:"open_without_routing",label:"Open without routing"},{value:"quoted",label:"Quoted"},{value:"closed",label:"Closed"},{value:"in_review",label:"In review"}],g=[{value:"none",label:"-None-"},{value:"draft",label:"Draft"},{value:"no_feedback",label:"No Feedback"},{value:"negotiation_price",label:"Negotiation Price"},{value:"negotiation_conditions",label:"Negotiation Conditions"},{value:"open",label:"Open"},{value:"lost",label:"Lost"},{value:"won",label:"Won"}],f={Header:{"Account Name":e(m,{defaultOptions:!0,isMulti:!1,id:"account_id",name:"account_id",placeholder:"Type at least 2 characters to search...",loadOptions:I,onChange:({value:t})=>{l("account_id",t)},defaultValue:{value:(p=a.account)==null?void 0:p.id,label:d("div",{className:"flex items-center",children:[a.account?e("img",{src:M(a.account.image),alt:"avatar",className:"w-8 h-8 mr-2 rounded-full"}):null,d("div",{children:[e("div",{className:"text-sm font-bold",children:(h=a.account)==null?void 0:h.account_name}),e("div",{className:"text-xs text-gray-500",children:(_=a.account)==null?void 0:_.email})]})]},(r=a.account)==null?void 0:r.id)},className:"flex-1"}),Contact:e(m,{defaultOptions:!0,isMulti:!1,id:"contact",name:"contact_id",placeholder:"Type at least 2 characters to search...",loadOptions:H,onChange:({value:t})=>{l("contact_id",t)},defaultValue:{value:(c=a.contact)==null?void 0:c.id,label:d("div",{className:"flex items-center",children:[a.contact?e("img",{src:a.contact.image??"/assets/images/user-profile.jpeg",alt:"avatar",className:"w-8 h-8 mr-2 rounded-full"}):null,d("div",{children:[e("div",{className:"text-sm font-bold",children:(s=a.contact)==null?void 0:s.name}),e("div",{className:"text-xs text-gray-500",children:(x=a.contact)==null?void 0:x.email})]})]},(V=a.contact)==null?void 0:V.id)},className:"flex-1"}),"Customer RFQ No":e("input",{id:"customer_rfq_no",name:"customer_rfq_no",className:"form-input flex-1 ",defaultValue:a.customer_rfq_no,onChange:t=>l(t.target.name,t.target.value)}),"Project Name / Application":e("input",{id:"project_name",name:"project_name",className:"form-input flex-1 ",defaultValue:a.project_name,onChange:t=>l(t.target.name,t.target.value)}),"RFQ Source":e(y,{name:"rfq_source",required:!0,options:i,onChange:({value:t})=>{l("rfq_source",t)},defaultValue:a.rfq_source?i.find(t=>t.value==a.rfq_source):{value:"none",label:"-None-"},className:"flex-1"}),"RFQ Type":e(y,{name:"rfq_type",required:!0,options:n,onChange:({value:t})=>{l("rfq_type",t)},defaultValue:a.rfq_type?n.find(t=>t.value==a.rfq_type):{value:"none",label:"-None-"},className:"flex-1"}),Status:e(y,{name:"status",required:!0,options:o,onChange:({value:t})=>{l("status",t)},defaultValue:a.status?o.find(t=>t.value==a.status):{value:"open",label:"Open"},className:"flex-1"}),"Date History":e(w,{name:"date_history",options:{dateFormat:"Y-m-d ",defaultDate:a.date_history?new Date(a.date_history):null},defaultValue:a.date_history,className:"form-input flex-1",placeholder:"YYYY-MM-DD",onChange:(t,v)=>l("date_history",v)}),"Exchange Rate":e("input",{id:"exchangeRate",type:"text",value:"1",placeholder:"Readonly input hereâ€¦",className:"flex-1 form-input disabled:pointer-events-none disabled:bg-[#eee] dark:disabled:bg-[#1b2e4b] cursor-not-allowed",disabled:!0}),"Portal BOM id":e("input",{id:"portal_bom_id",name:"portal_bom_id",onChange:t=>l(t.target.name,t.target.value),defaultValue:a.portal_bom_id,className:"form-input flex-1 "})},"":{"RFQ Owner":e(m,{defaultOptions:!0,isMulti:!1,id:"owner_id",placeholder:"Type at least 2 characters to search...",loadOptions:B,onChange:({value:t})=>{l("owner_id",t)},defaultValue:{value:(R=a.owner)==null?void 0:R.id,label:d("div",{className:"flex items-center",children:[a.owner?e("img",{src:M(a.owner.avatar_data),alt:"avatar",className:"w-8 h-8 mr-2 rounded-full"}):null,d("div",{children:[e("div",{className:"text-sm font-bold",children:((O=a.owner)==null?void 0:O.first_name)+" "+((D=a.owner)==null?void 0:D.last_name)}),e("div",{className:"text-xs text-gray-500",children:(T=a.owner)==null?void 0:T.email})]})]},(Q=a.owner)==null?void 0:Q.id)},className:"flex-1"}),"Deal Stage":e(y,{name:"deal_stage",options:g,onChange:({value:t})=>{l("deal_stage",t)},defaultValue:g.find(t=>t.value==a.deal_stage),className:"flex-1"}),"Customer RFQ File":e(ee,{id:"customer_rfq_file",modelName:"rfq",formState:a,formAttribute:"customer_rfq_file",updateFormData:b}),"RFQ Dead Line":e(w,{name:"rfq_dead_line",options:{dateFormat:"Y-m-d ",defaultDate:a.rfq_dead_line?new Date(a.rfq_dead_line):null},defaultValue:a.rfq_dead_line,className:"form-input flex-1",placeholder:"YYYY-MM-DD",onChange:(t,v)=>l("rfq_dead_line",v)}),Currency:e(y,{name:"currency",id:"currency",options:P,className:"flex-1",onChange:({value:t})=>{l("currency",t)},defaultValue:P.find(t=>t.value==a.currency)}),"Vendor RFQs Line":e(m,{defaultOptions:!0,id:"vendor_rfqs_line",name:"vendor_rfqs_line",placeholder:"Type at least 2 characters to search...",loadOptions:U,onChange:t=>{l("vendor_rfqs_lines",t.map(v=>v.value))},defaultValue:a.vendor_rfqs_line?a.vendor_rfqs_line.map(t=>({value:t.id,label:e("div",{className:"flex items-center",children:e("div",{children:e("div",{className:"text-sm font-bold",children:t.vendor_name})})},t.id)})):[],isMulti:!0,className:"flex-1"})}};return e(F,{children:e("div",{className:"flex justify-between lg:flex-row flex-col",children:e(S,{fields:f})})})},ne=()=>{const a=j().id;return d("div",{className:"mt-8 px-4",children:[e(se,{}),e("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),e(te,{}),e("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),e(le,{}),e("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),e(ae,{modelId:a,modelName:"rfq"})]})},ve=()=>{const{hasPermission:u}=$(),a=C(r=>r.rfqFormSlice),l=q(),i=new W,[n,o]=N.useState(!0),f=j().id,p=G();N.useEffect(()=>{l(J("RFQ Edit"))}),N.useEffect(()=>{l(A())},[]),N.useEffect(()=>{h().then(()=>{o(!1)})},[f]),N.useEffect(()=>{l(b({api:"updateSingleRfq",redirectTo:"/rfq/edit/:id",action:"edit"}))},[]);const h=async()=>{const r=await i.fetchSingleRfq(f);if(r.status!=200)return;const c=r.data.data.rfq;l(b(c))};if(n)return e(E,{});const _=async()=>{try{const r=await i.convertRfqToQuote({id:a.id});K.fire({title:"Rfq Converted Successfully.",html:`
                <span class="text-blue-500">Do you want to redirect to created Quote ? </span>
                `,showCancelButton:!0,icon:"success",confirmButtonText:"Redirect",denyButtonText:"Close",customClass:{title:"text-blue-500"}}).then(c=>{c.isConfirmed&&p(`/quotes/edit/${r.data.quote.id}`,{replace:!0})})}catch(r){Z("Failed to convert Rfq"),console.error(r);return}};return!u("update-rfq")||n?e(E,{}):d("div",{className:"px-4",children:[e(z,{formState:a,resetForm:A}),e("div",{className:"flex xl:flex-row flex-col gap-2.5",children:d("div",{className:"panel px-0 flex-1 py-6 ltr:xl:mr-6 rtl:xl:ml-6",children:[e("button",{onClick:_,className:"mx-5 btn btn-secondary gap-2",children:"Convert RFQ to Quote"}),e(ne,{})]})})]})};export{ve as default};
