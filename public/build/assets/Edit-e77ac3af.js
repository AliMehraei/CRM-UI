import{u as k,d as F,a as Q,j as e,A as I,n as W,b as s,f as B,x as V,v as H,K as J,G as X,t as q,F as w,a$ as N,r as b,a0 as ee,h as Y,c as te,s as ae,b0 as M,e as L}from"./main-cc930730.js";import{G as Z}from"./GenerateFields-ca92ba6c.js";import{F as z}from"./index-32e02fa5.js";import{S as T}from"./react-select.esm-777eacc9.js";import{Z as G,_ as U}from"./SelectOptions-2f384ec2.js";import{k as O,E as ne}from"./EditPencilIcon-cd3ef1ad.js";import{$ as le}from"./transition-f2e0b105.js";import{A as ie}from"./AttachmentSection-9e25cbd6.js";import{A as se}from"./ActionButtonsComponent-f2bdc3c7.js";/* empty css                  */import"./use-is-mounted-434be8c0.js";import"./use-resolve-button-type-29f5909e.js";import"./index-ccdbb5d1.js";const re=()=>{var d,h,_,m,g,x,n,o,a,f,y,C,S,j,A,E;const u=k(),t=F(l=>l.invoiceForm),r=new Q,i=(l,v)=>{u(N({[l]:v}))},c=async l=>{const v=await r.fetchSingleAccount(l);if(v.status!=200)return;const P=v.data.data.account;u(N({account:P}));const K=["billing_street","billing_city","billing_state","billing_code","billing_country","shipping_street","shipping_city","shipping_state","shipping_code","shipping_country"],R={};K.forEach($=>{R[$]=P[$]??null}),u(N(R))},p={"Invoice Information":{"Invoice Owner":e(I,{defaultOptions:!0,isMulti:!1,id:"owner_id",name:"owner_id",placeholder:"Type at least 2 characters to search...",loadOptions:W,className:"flex-1",onChange:({value:l})=>{i("owner_id",l)},defaultValue:{value:(d=t.owner)==null?void 0:d.id,label:s("div",{className:"flex items-center",children:[t.owner?e("img",{src:B(t.owner.avatar_data),alt:"avatar",className:"w-8 h-8 mr-2 rounded-full"}):null,s("div",{children:[e("div",{className:"text-sm font-bold",children:((h=t.owner)==null?void 0:h.first_name)+" "+((_=t.owner)==null?void 0:_.last_name)}),e("div",{className:"text-xs text-gray-500",children:(m=t.owner)==null?void 0:m.email})]}),e("button",{className:"btn text-xs btn-sm ml-auto",onClick:()=>{var l,v;return V(`${((l=t.owner)==null?void 0:l.first_name)+" "+((v=t.owner)==null?void 0:v.last_name)}`)},children:"Copy & Select"})]},(g=t.owner)==null?void 0:g.id)}}),Subject:e("input",{id:"subject",required:!0,name:"subject",className:"form-input flex-1 ",onChange:l=>i(l.target.name,l.target.value),defaultValue:t.subject}),"Invoice Date":e(z,{options:{dateFormat:"Y-m-d",position:"auto left",defaultDate:t.invoice_date?new Date(t.invoice_date):null},value:t.invoice_date,className:"form-input flex-1",name:"invoice_date",onChange:(l,v)=>i("invoice_date",v)}),"Due Date":e(z,{options:{dateFormat:"Y-m-d",position:"auto left",defaultDate:t.due_date?new Date(t.due_date):null},value:t.invoice_date,name:"due_date",className:"form-input flex-1",onChange:(l,v)=>i("due_date",v)}),"Sales Commission":e("input",{id:"sales_commission",name:"sales_commission",defaultValue:t.sales_commission,className:"form-input flex-1 ",onChange:l=>i(l.target.name,l.target.value)}),"Account Name":e(I,{defaultOptions:!0,isMulti:!1,required:!0,id:"account_id",placeholder:"Type at least 2 characters to search...",name:"account_id",loadOptions:H,onChange:({value:l})=>{i("account_id",l),c(l)},className:"flex-1",defaultValue:{value:(x=t.account)==null?void 0:x.id,label:s("div",{className:"flex items-center",children:[t.account?e("img",{src:B(t.account.image),alt:"avatar",className:"w-8 h-8 mr-2 rounded-full"}):null,s("div",{children:[e("div",{className:"text-sm font-bold",children:(n=t.account)==null?void 0:n.account_name}),e("div",{className:"text-xs text-gray-500",children:(o=t.account)==null?void 0:o.email})]}),e("button",{className:"btn text-xs btn-sm ml-auto",onClick:()=>{var l;return V(`${(l=t.account)==null?void 0:l.account_name}`)},children:"Copy & Select"})]},(a=t.account)==null?void 0:a.id)}}),"Exchange Rate":e("input",{id:"exchangeRate",type:"text",value:"1",placeholder:"readOnly input here…",className:"flex-1 form-input disabled:pointer-events-none disabled:bg-[#eee] dark:disabled:bg-[#1b2e4b] cursor-not-allowed",disabled:!0}),ZohoBooksID:e("input",{id:"zoho_books_id",name:"zoho_books_id",defaultValue:t.zoho_books_id,className:"form-input flex-1 ",onChange:l=>i(l.target.name,l.target.value)})},"":{"Sales Order":e(I,{defaultOptions:!0,isMulti:!1,id:"sales_order_id",placeholder:"Type at least 2 characters to search...",name:"sales_order_id",loadOptions:J,onChange:({value:l})=>{i("sales_order_id",l)},defaultValue:{value:(f=t.sales_order)==null?void 0:f.id,label:s("div",{className:"flex items-center",children:[e("div",{className:"text-sm font-bold",children:(y=t.sales_order)==null?void 0:y.subject}),t.sales_order?e("button",{className:"btn text-xs btn-sm ml-auto",onClick:()=>{var l;return V(`${(l=t.sales_order)==null?void 0:l.subject}`)},children:"Copy & Select"}):null]},(C=t.sales_order)==null?void 0:C.id)},className:"flex-1"}),"Purchase Order":e("input",{id:"purchase_order",name:"purchase_order",className:"form-input flex-1 ",defaultValue:t.purchase_order,onChange:l=>i(l.target.name,l.target.value)}),"Deal Stage":e(T,{name:"deal_stage",id:"deal_stage",placeholder:"",options:G,defaultValue:G.find(l=>l.value==t.deal_stage),onChange:({value:l})=>{i("deal_stage",l)}}),"Excise Duty":e("input",{id:"excise_duty",name:"excise_duty",className:"form-input flex-1 ",defaultValue:t.excise_duty,onChange:l=>i(l.target.name,l.target.value)}),Status:e(T,{name:"status",id:"status",placeholder:"",options:U,onChange:({value:l})=>{i("status",l)},defaultValue:U.find(l=>l.value==t.status)}),"Contact Name":e(I,{defaultOptions:!0,isMulti:!1,id:"contact_id",placeholder:"Type at least 2 characters to search...",name:"contact_id",loadOptions:X,onChange:({value:l})=>{i("contact_id",l)},defaultValue:{value:(S=t.contact)==null?void 0:S.id,label:s("div",{className:"flex items-center",children:[s("div",{className:"text-sm font-bold",children:[(j=t.contact)==null?void 0:j.first_name," ",(A=t.contact)==null?void 0:A.last_name]}),t.contact?e("button",{className:"btn text-xs btn-sm ml-auto",onClick:()=>{var l,v;return V(`${((l=t.contact)==null?void 0:l.first_name)+((v=t.contact)==null?void 0:v.last_name)}`)},children:"Copy & Select"}):null]},(E=t.contact)==null?void 0:E.id)},className:"flex-1"}),Currency:e(T,{id:"currency",name:"currency",options:q,defaultValue:q.find(l=>l.value==t.currency),className:"flex-1"})}};return e(w,{children:e("div",{className:"flex justify-between lg:flex-row flex-col",children:e(Z,{fields:p})})})},oe=()=>{var c,p,d,h,_,m,g,x,n,o;const u=k(),t=F(a=>a.invoiceForm),r=(a,f)=>{u(N({[a]:f}))},i={"Address Information":{"Billing Street":e("input",{id:"billing_street",name:"billing_street",onChange:a=>r(a.target.name,a.target.value),value:t.billing_street||((c=t.account)==null?void 0:c.billing_street)||"",defaultValue:t.billing_street,className:"form-input flex-1"}),"Billing City":e("input",{id:"billing_city",name:"billing_city",value:t.billing_city||((p=t.account)==null?void 0:p.billing_city)||"",defaultValue:t.billing_city,onChange:a=>r(a.target.name,a.target.value),className:"form-input flex-1"}),"Billing State":e("input",{id:"billing_state",name:"billing_state",value:t.billing_state||((d=t.account)==null?void 0:d.billing_state)||"",defaultValue:t.billing_state,onChange:a=>r(a.target.name,a.target.value),className:"form-input flex-1"}),"Billing Code":e("input",{id:"billing_code",name:"billing_code",value:t.billing_code||((h=t.account)==null?void 0:h.billing_code)||"",defaultValue:t.billing_code,onChange:a=>r(a.target.name,a.target.value),className:"form-input flex-1"}),"Billing Country":e("input",{id:"billing_country",name:"billing_country",value:t.billing_country||((_=t.account)==null?void 0:_.billing_country)||"",defaultValue:t.billing_country,onChange:a=>r(a.target.name,a.target.value),className:"form-input flex-1"})},"":{"Shipping Street":e("input",{id:"shipping_street",name:"shipping_street",defaultValue:t.shipping_street,value:t.shipping_street||((m=t.account)==null?void 0:m.shipping_street)||"",onChange:a=>r(a.target.name,a.target.value),className:"form-input flex-1"}),"Shipping City":e("input",{id:"shipping_city",name:"shipping_city",defaultValue:t.shipping_city,value:t.shipping_city||((g=t.account)==null?void 0:g.shipping_city)||"",onChange:a=>r(a.target.name,a.target.value),className:"form-input flex-1"}),"Shipping State":e("input",{id:"shipping_state",name:"shipping_state",value:t.shipping_state||((x=t.account)==null?void 0:x.shipping_state)||"",defaultValue:t.shipping_state,onChange:a=>r(a.target.name,a.target.value),className:"form-input flex-1"}),"Shipping Code":e("input",{id:"shipping_code",name:"shipping_code",value:t.shipping_code||((n=t.account)==null?void 0:n.shipping_code)||"",defaultValue:t.shipping_code,onChange:a=>r(a.target.name,a.target.value),className:"form-input flex-1"}),"Shipping Country":e("input",{id:"shipping_country",name:"shipping_country",value:t.shipping_country||((o=t.account)==null?void 0:o.shipping_country)||"",defaultValue:t.shipping_country,onChange:a=>r(a.target.name,a.target.value),className:"form-input flex-1"})}};return e(w,{children:e("div",{className:"flex justify-between lg:flex-row flex-col",children:e(Z,{fields:i})})})},D=({item:u,field:t,handleChangeField:r})=>{const[i,c]=b.useState(!0),p=b.useRef(null),d=b.useRef(null),h=b.useRef(null),_=()=>{c(g=>!g)},m=()=>{var x,n,o;let g;i?g=(d.current?parseFloat((x=d.current)==null?void 0:x.value):0)/100*u.amount:g=h.current?parseFloat((n=h.current)==null?void 0:n.value):0,r(t,g,u.id),(o=p.current)==null||o.click()};return e(w,{children:e(O,{className:"relative",children:({open:g})=>s(w,{children:[e(O.Button,{ref:p,className:"btn w-5 h-5 p-0 rounded-full ml-1",children:e(ne,{})}),e(le,{as:b.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:e(O.Panel,{className:"absolute left-1/2 z-10 mt-3  max-w-sm -translate-x-1/2 transform px-4 sm:px-0 w-80",children:e("div",{className:"overflow-hidden rounded-lg shadow-lg ring-1 ring-black ring-opacity-5 ",children:s("div",{className:"relative grid gap-8 bg-white p-7 w-full",children:[s("div",{className:"flex gap-3",children:[s("label",{className:"inline-block",children:[e("input",{checked:i,type:"radio",name:"type",className:"form-radio",onChange:_}),e("span",{children:"Percentage"})]}),e("input",{name:"total",ref:d,hidden:!i,className:"form-input mx-2 w-20  h-8  cursor-text"})]}),s("div",{className:"block gap-3",children:[s("label",{className:"inline-block",children:[e("input",{checked:!i,type:"radio",name:"type",className:"form-radio",onChange:_}),e("span",{className:"",children:"Direct Price Reduction"})]}),e("input",{ref:h,name:"total",hidden:i,className:"form-input mx-2 w-20 h-8 cursor-text"})]}),s("div",{className:"flex gap-3",children:[e("button",{className:"btn btn-primary",onClick:m,children:"Submit"}),e("button",{className:"btn btn-warning",onClick:()=>{var x;return(x=p.current)==null?void 0:x.click()},children:"Cancel"})]})]})})})})]})})})},ce=()=>{const u=F(n=>n.invoiceForm),t=k(),[r,i]=b.useState({amount:0,subtotal:0,discount:0,tax:0,adjustment:0,grandTotal:0,...u.summary,...u.tax,...u.discount,...u.adjustment}),[c,p]=b.useState([]);b.useEffect(()=>{p(Object.values(u.items))},[]);const d=(n,o,a)=>{const f={...c.find(S=>S.id===a)};f[n]=o;const y=(parseFloat(f.quantity)||0)*(parseFloat(f.list_price)||0),C=y-((parseFloat(f.discount)||0)+(parseFloat(f.tax)||0));f.amount=y,f.total=C,h(f)},h=n=>{const o=c.map(a=>a.id===n.id?{...a,...n}:a);p(o),t(N({items:o}))},_=()=>{let n;n=c!=null&&c.length?c.reduce((o,a)=>a.id>o?a.id:o,c[0].id):0,p([...c,{id:n+1,product_id:null,description:null,quantity:null,list_price:null,amount:null,discount:null,tax:null,total:null}])},m=(n,o)=>{const a={...r};a[n]=parseFloat(o),a.grandTotal=a.subtotal-a.discount+a.tax+a.adjustment,i(a)};b.useEffect(()=>{t(N({summary:r}))},[r]);const g=(n=null)=>{p(c.filter(o=>o.id!==n.id))},x=()=>{const n=c.reduce((S,j)=>S+(parseFloat(j.total)||0),0),o=n,a=r.discount,f=r.tax,y=r.adjustment,C=n-a+f+y;i({amount:o,subtotal:n,discount:a,tax:f,adjustment:y,grandTotal:C})};return b.useEffect(()=>{x()},[c]),e(w,{children:e("div",{className:"flex justify-between lg:flex-row flex-col",children:e("div",{className:" w-full ltr:lg:mr-12 rtl:lg:ml-12 mb-12",children:s("div",{className:"",children:[e("div",{className:"text-lg",children:"Invoice Items :"}),s("div",{className:"mt-8",children:[e("div",{className:"overflow-x",children:s("table",{className:"table-auto overflow-scroll w-full",children:[e("thead",{children:s("tr",{children:[e("th",{className:"w-1",children:"S.NO"}),e("th",{className:"w-full",children:"Product Name"}),e("th",{className:"w-1",children:"Quantity"}),e("th",{className:"w-1",children:"List Price"}),e("th",{className:"w-1",children:"Amount"}),e("th",{className:"w-1",children:"Discount"}),e("th",{className:"w-1",children:"Tax"}),e("th",{className:"w-1",children:"Total"})]})}),e("tbody",{children:c.map(n=>{var o;return s("tr",{className:"align-top",children:[e("td",{children:n.id}),s("td",{children:[e(I,{defaultOptions:!1,isMulti:!1,id:"product_id",name:"product_id",placeholder:"Type at least 2 characters to search...",loadOptions:ee,onChange:({value:a})=>{d("product_id",a,n.id)},className:"flex-1  min-w-[200px]",defaultValue:{value:n.id,label:e("div",{className:"flex items-center",children:e("div",{children:e("div",{className:"text-sm font-bold",children:(o=n.product)==null?void 0:o.product_name})})},n.id)}}),e("textarea",{name:"description",className:"form-textarea mt-4 flex-1",placeholder:"Enter Description",defaultValue:n.description,onChange:a=>d(a.target.name,a.target.value,n.id)})]}),e("td",{children:e("input",{name:"quantity",type:"text",className:"form-input min-w-[200px]",defaultValue:n.quantity,onChange:a=>d(a.target.name,a.target.value,n.id)})}),e("td",{children:e("input",{type:"number",className:"form-input w-32",placeholder:"Price",name:"list_price",min:0,defaultValue:n.list_price,onChange:a=>d(a.target.name,a.target.value,n.id)})}),e("td",{children:e("input",{name:"amount",type:"number",className:"form-input min-w-[200px]  form-input disabled:pointer-events-none bg-[#eee] dark:bg-[#1b2e4b]  cursor-text",value:n.amount,disabled:!0,onChange:a=>d(a.target.name,a.target.value,n.id)})}),e("td",{children:s("div",{className:"flex",children:[e("input",{name:"discount",type:"number",className:"form-input min-w-[200px]  form-input disabled:pointer-events-none bg-[#eee] dark:bg-[#1b2e4b]  cursor-text",value:n.discount,disabled:!0,onChange:a=>d(a.target.name,a.target.value,n.id)}),e(D,{item:n,handleChangeField:d,field:"discount"})]})}),e("td",{children:s("div",{className:"flex",children:[e("input",{name:"tax",type:"number",className:"form-input min-w-[200px]  form-input disabled:pointer-events-none bg-[#eee] dark:bg-[#1b2e4b]  cursor-text",value:n.tax,disabled:!0,onChange:a=>d(a.target.name,a.target.value,n.id)}),e(D,{item:n,handleChangeField:d,field:"tax"})]})}),e("td",{children:e("input",{name:"total",type:"number",className:"form-input min-w-[200px]  form-input disabled:pointer-events-none bg-[#eee] dark:bg-[#1b2e4b]  cursor-text",value:n.total,disabled:!0,onChange:a=>d(a.target.name,a.target.value,n.id)})}),e("td",{children:e("button",{type:"button",onClick:()=>g(n),children:s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})})]},n.id)})})]})}),s("div",{className:"flex justify-between sm:flex-row flex-col mt-6 px-4",children:[e("div",{className:"sm:mb-0 mb-6",children:e("button",{type:"button",className:"btn btn-primary",onClick:()=>_(),children:"Add Item"})}),s("div",{className:"sm:w-2/5",children:[s("div",{className:"flex items-center justify-between",children:[e("div",{children:"Subtotal(€)"}),e("input",{id:"subtotal",name:"subtotal",type:"text",value:r.subtotal,className:"w-64 form-input disabled:pointer-events-none disabled:bg-[#eee] dark:disabled:bg-[#1b2e4b] disabled:cursor-not-allowed",disabled:!0})]}),s("div",{className:"flex items-center justify-between mt-4",children:[e("div",{children:"Discount(€)"}),s("div",{className:"flex",children:[e("input",{id:"discount",name:"discount",type:"text",value:r.discount,disabled:!0,className:"w-56 form-input disabled:pointer-events-none bg-[#eee] dark:bg-[#1b2e4b] cursor-text"}),e(D,{item:r,handleChangeField:m,field:"discount"})]})]}),s("div",{className:"flex items-center justify-between mt-4",children:[e("div",{children:"Tax(€)"}),s("div",{className:"flex",children:[e("input",{id:"tax",name:"tax",type:"text",value:r.tax,disabled:!0,className:"w-56 form-input disabled:pointer-events-none bg-[#eee] dark:bg-[#1b2e4b]  cursor-text"}),e(D,{item:r,handleChangeField:m,field:"tax"})]})]}),s("div",{className:"flex items-center justify-between mt-4",children:[e("div",{children:"Adjustment(€)"}),e("input",{id:"adjustment",name:"adjustment",type:"text",value:r.adjustment,onChange:n=>m(n.target.name,n.target.value),className:"w-64 form-input "})]}),s("div",{className:"flex items-center justify-between mt-4 font-semibold",children:[e("div",{className:"flex-1",children:"Grand Total(€)"}),e("input",{id:"grand_total",name:"grand_total",type:"text",value:r.grandTotal,className:"w-64 form-input disabled:pointer-events-none disabled:bg-[#eee] dark:disabled:bg-[#1b2e4b] cursor-not-allowed",disabled:!0})]})]})]})]})]},"Quote Items")})})})},de=()=>{const u=k(),t=F(i=>i.invoiceForm),r=(i,c)=>{u(N({[i]:c}))};return e(w,{children:e("div",{className:"flex justify-between lg:flex-row flex-col",children:e("div",{className:"lg:w-1/2 w-full ltr:lg:mr-6 rtl:lg:ml-6 mb-6",children:s("div",{className:"",children:[e("div",{className:"text-lg",children:"Terms and Conditions :"}),s("div",{className:"mt-4 flex items-center",children:[e("label",{className:"ltr:mr-2 rtl:ml-2 w-1/3 mb-0",children:"Terms and Conditions"}),e("textarea",{id:"terms_and_conditions",rows:3,name:"terms_conditions",className:"form-textarea flex-1",onChange:i=>r(i.target.name,i.target.value),value:t.terms_conditions,placeholder:""})]},"terms_and_conditions")]},"Terms and Conditions")})})})},ue=()=>{const u=k(),t=F(i=>i.invoiceForm),r=(i,c)=>{u(N({[i]:c}))};return e(w,{children:e("div",{className:"flex justify-between lg:flex-row flex-col",children:e("div",{className:"lg:w-1/2 w-full ltr:lg:mr-6 rtl:lg:ml-6 mb-6",children:s("div",{className:"",children:[e("div",{className:"text-lg",children:"Description Information :"}),s("div",{className:"mt-4 flex items-center",children:[e("label",{className:"ltr:mr-2 rtl:ml-2 w-1/3 mb-0",children:"Description"}),e("textarea",{id:"description",rows:3,name:"description",className:"form-textarea flex-1",onChange:i=>r(i.target.name,i.target.value),value:t.description,placeholder:""})]},"description")]},"Terms and Conditions")})})})},me=()=>{const t=Y().id;return s("div",{className:"mt-8 px-4",children:[e(re,{},"invoiceInformation"),e("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),e(oe,{}),e("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),e(ce,{}),e("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),e(de,{}),e("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),e(ue,{}),e("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6"}),e(ie,{modelId:t,modelName:"invoice"})]})},ke=()=>{const{hasPermission:u}=te(),t=F(m=>m.invoiceForm),[r,i]=b.useState(!0),p=Y().id,d=new Q,h=k();b.useEffect(()=>{h(ae("Invoice Edit"))}),b.useEffect(()=>{h(M())},[]);const _=async()=>{const m=await d.fetchSingleInvoice(p);if(m.status!=200)return;const g=m.data.data.invoice;h(N(g))};return b.useEffect(()=>{_().then(()=>{i(!1)})},[p]),b.useEffect(()=>{h(N({api:"updateSingleInvoice",redirectTo:"/invoice/edit/:id",action:"edit"}))},[]),r?e(L,{}):!u("update-invoice")||r?e(L,{}):s("div",{className:"px-4",children:[e(se,{formState:t,resetForm:M}),e("div",{className:"flex xl:flex-row flex-col gap-2.5",children:e("div",{className:"panel px-0 flex-1 py-6 ltr:xl:mr-6 rtl:xl:ml-6 overflow-hidden",children:e(me,{})})})]})};export{ke as default};
